
"**********************************************************************************

*                           The License						                                      *

* 										                                                                  *

* The user is free to produce commercial applications with the software, to 	          *

* distribute these applications in source or binary  form, and to charge monies         *

* for them as he sees fit and in concordance with the laws of the land subject 	        *

* to the following license.							                                                *

*										                                                                    * 

* 1. The license applies to all the software and all derived software and 	            *

*    must appear on such.							                                                  *

*										                                                                    *

* 2. It is illegal to distribute the software without this license attached	            *

*    to it and use of the software implies agreement with the license as such.          *

*    It is illegal for anyone who is not the copyright holder to tamper with 	          *

*    or change the license.							                                                *

*										                                                                    *

* 3. Neither the names of Lambda Associates or the copyright holder may be used         *

*    to endorse or promote products built using the software without specific 	        *

*    prior written permission from the copyright holder.		                            *

*										                                                                    *

* 4. That possession of this license does not confer on the copyright holder 	          *

*    any special contractual obligation towards the user. That in no event 	            * 

*    shall the copyright holder be liable for any direct, indirect, incidental,        *   

*    special, exemplary or consequential damages (including but not limited             *

*    to procurement of substitute goods or services, loss of use, data, 	              * 

*    interruption), however caused and on any theory of liability, whether in	          * 

*    contract, strict liability or tort (including negligence) arising in any         	*

*    way out of the use of the software, even if advised of the possibility of         	*

*    such damage.						                                                        		* 

*										                                                                    *

* 5. It is permitted for the user to change the software, for the purpose of 	          *

*    improving performance, correcting an error, or porting to a new platform, 	        *

*    and distribute the derived version of Shen provided the resulting program 	        *

*    conforms in all respects to the Shen standard and is issued under that             * 

*    title. The user must make it clear with his distribution that he/she is 	          *

*    the author of the changes and what these changes are and why. 		                  *

*										                                                                    *

* 6. Derived versions of this software in whatever form are subject to the same         *

*    restrictions. In particular it is not permitted to make derived copies of          *

*    this software which do not conform to the Shen standard or appear under a          *

*    different title.								                                                    *

*										                                                                    *

*    It is permitted to distribute versions of Shen which incorporate libraries,        *

*    graphics or other facilities which are not part of the Shen standard.	            *

*										                                                                    *

* For an explication of this license see www.shenlanguage.org/license.htm which         *

* explains this license in full.                                                        *

*				 						                                                                    *

*****************************************************************************************

"

(DEFUN shen.typecheck (V2826 V2827)
 (LET ((Curry (shen.curry V2826)))
  (LET ((ProcessN (shen.start-new-prolog-process)))
   (LET
    ((Type
      (shen.insert-prolog-variables (shen.demodulate (shen.curry-type V2827))
       ProcessN)))
    (LET ((Continuation (freeze (return Type ProcessN 'shen.void))))
     (shen.t* (CONS Curry (CONS '|:| (CONS Type NIL))) NIL ProcessN
      Continuation))))))

(DEFUN shen.curry (V2828)
 (COND
  ((AND (CONSP V2828) (shen.wrapper (shen.special? (CAR V2828))))
   (CONS (CAR V2828) (map 'shen.curry (CDR V2828))))
  ((AND (CONSP V2828)
    (AND (CONSP (CDR V2828)) (shen.wrapper (shen.extraspecial? (CAR V2828)))))
   V2828)
  ((AND (CONSP V2828)
    (AND (EQ 'type (CAR V2828))
     (AND (CONSP (CDR V2828))
      (AND (CONSP (CDR (CDR V2828))) (NULL (CDR (CDR (CDR V2828))))))))
   (CONS 'type (CONS (shen.curry (CAR (CDR V2828))) (CDR (CDR V2828)))))
  ((AND (CONSP V2828) (AND (CONSP (CDR V2828)) (CONSP (CDR (CDR V2828)))))
   (shen.curry
    (CONS (CONS (CAR V2828) (CONS (CAR (CDR V2828)) NIL)) (CDR (CDR V2828)))))
  ((AND (CONSP V2828) (AND (CONSP (CDR V2828)) (NULL (CDR (CDR V2828)))))
   (CONS (shen.curry (CAR V2828)) (CONS (shen.curry (CAR (CDR V2828))) NIL)))
  (T V2828)))

(DEFUN shen.special? (V2829) (element? V2829 shen.*special*))

(DEFUN shen.extraspecial? (V2830) (element? V2830 shen.*extraspecial*))

(DEFUN shen.t* (V2831 V2832 V2833 V2834)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET
    ((Case
      (LET ((Error (shen.newpv V2833)))
       (do (shen.incinfs)
        (fwhen (shen.maxinfexceeded?) V2833
         (freeze (bind Error (shen.errormaxinfs) V2833 V2834)))))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET
      ((Case
        (LET ((V2820 (shen.lazyderef V2831 V2833)))
         (IF (EQ 'fail V2820)
          (do (shen.incinfs)
           (cut Throwcontrol V2833 (freeze (shen.prolog-failure V2833 V2834))))
          'false))))
      (IF (shen.ABSEQUAL Case 'false)
       (LET
        ((Case
          (LET ((V2821 (shen.lazyderef V2831 V2833)))
           (IF (CONSP V2821)
            (LET ((X (CAR V2821)))
             (LET ((V2822 (shen.lazyderef (CDR V2821) V2833)))
              (IF (CONSP V2822)
               (LET ((V2823 (shen.lazyderef (CAR V2822) V2833)))
                (IF (EQ '|:| V2823)
                 (LET ((V2824 (shen.lazyderef (CDR V2822) V2833)))
                  (IF (CONSP V2824)
                   (LET ((A (CAR V2824)))
                    (LET ((V2825 (shen.lazyderef (CDR V2824) V2833)))
                     (IF (NULL V2825)
                      (do (shen.incinfs)
                       (fwhen (shen.type-theory-enabled?) V2833
                        (freeze
                         (cut Throwcontrol V2833
                          (freeze (shen.th* X A V2832 V2833 V2834))))))
                      'false)))
                   'false))
                 'false))
               'false)))
            'false))))
        (IF (shen.ABSEQUAL Case 'false)
         (LET ((Datatypes (shen.newpv V2833)))
          (do (shen.incinfs)
           (shen.show V2831 V2832 V2833
            (freeze
             (bind Datatypes shen.*datatypes* V2833
              (freeze (shen.udefs* V2831 V2832 Datatypes V2833 V2834)))))))
         Case))
       Case))
     Case)))))

(DEFUN shen.type-theory-enabled? NIL shen.*shen-type-theory-enabled?*)

(DEFUN enable-type-theory (V2839)
 (COND ((EQ '+ V2839) (set 'shen.*shen-type-theory-enabled?* 'true))
  ((EQ '- V2839) (set 'shen.*shen-type-theory-enabled?* 'false))
  (T
   (simple-error
    "enable-type-theory expects a + or a -
"))))

(DEFUN shen.prolog-failure (V2848 V2849) 'false)

(DEFUN shen.maxinfexceeded? NIL
 (shen.greater? (inferences) shen.*maxinferences*))

(DEFUN shen.errormaxinfs NIL (simple-error "maximum inferences exceeded~%"))

(DEFUN shen.udefs* (V2850 V2851 V2852 V2853 V2854)
 (LET
  ((Case
    (LET ((V2816 (shen.lazyderef V2852 V2853)))
     (IF (CONSP V2816)
      (LET ((D (CAR V2816)))
       (do (shen.incinfs)
        (call (CONS D (CONS V2850 (CONS V2851 NIL))) V2853 V2854)))
      'false))))
  (IF (shen.ABSEQUAL Case 'false)
   (LET ((V2817 (shen.lazyderef V2852 V2853)))
    (IF (CONSP V2817)
     (LET ((Ds (CDR V2817)))
      (do (shen.incinfs) (shen.udefs* V2850 V2851 Ds V2853 V2854)))
     'false))
   Case)))

(DEFUN shen.th* (V2855 V2856 V2857 V2858 V2859)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET
    ((Case
      (do (shen.incinfs)
       (shen.show (CONS V2855 (CONS '|:| (CONS V2856 NIL))) V2857 V2858
        (freeze (fwhen 'false V2858 V2859))))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET
      ((Case
        (LET ((F (shen.newpv V2858)))
         (do (shen.incinfs)
          (fwhen (shen.typedf? (shen.lazyderef V2855 V2858)) V2858
           (freeze
            (bind F (shen.sigf (shen.lazyderef V2855 V2858)) V2858
             (freeze (call (CONS F (CONS V2856 NIL)) V2858 V2859)))))))))
      (IF (shen.ABSEQUAL Case 'false)
       (LET ((Case (do (shen.incinfs) (shen.base V2855 V2856 V2858 V2859))))
        (IF (shen.ABSEQUAL Case 'false)
         (LET
          ((Case
            (do (shen.incinfs)
             (shen.by_hypothesis V2855 V2856 V2857 V2858 V2859))))
          (IF (shen.ABSEQUAL Case 'false)
           (LET
            ((Case
              (LET ((V2701 (shen.lazyderef V2855 V2858)))
               (IF (CONSP V2701)
                (LET ((F (CAR V2701)))
                 (LET ((V2702 (shen.lazyderef (CDR V2701) V2858)))
                  (IF (NULL V2702)
                   (do (shen.incinfs)
                    (shen.th* F (CONS '--> (CONS V2856 NIL)) V2857 V2858
                     V2859))
                   'false)))
                'false))))
            (IF (shen.ABSEQUAL Case 'false)
             (LET
              ((Case
                (LET ((V2703 (shen.lazyderef V2855 V2858)))
                 (IF (CONSP V2703)
                  (LET ((F (CAR V2703)))
                   (LET ((V2704 (shen.lazyderef (CDR V2703) V2858)))
                    (IF (CONSP V2704)
                     (LET ((X (CAR V2704)))
                      (LET ((V2705 (shen.lazyderef (CDR V2704) V2858)))
                       (IF (NULL V2705)
                        (LET ((B (shen.newpv V2858)))
                         (do (shen.incinfs)
                          (shen.th* F (CONS B (CONS '--> (CONS V2856 NIL)))
                           V2857 V2858
                           (freeze (shen.th* X B V2857 V2858 V2859)))))
                        'false)))
                     'false)))
                  'false))))
              (IF (shen.ABSEQUAL Case 'false)
               (LET
                ((Case
                  (LET ((V2706 (shen.lazyderef V2855 V2858)))
                   (IF (CONSP V2706)
                    (LET ((V2707 (shen.lazyderef (CAR V2706) V2858)))
                     (IF (EQ 'cons V2707)
                      (LET ((V2708 (shen.lazyderef (CDR V2706) V2858)))
                       (IF (CONSP V2708)
                        (LET ((X (CAR V2708)))
                         (LET ((V2709 (shen.lazyderef (CDR V2708) V2858)))
                          (IF (CONSP V2709)
                           (LET ((Y (CAR V2709)))
                            (LET ((V2710 (shen.lazyderef (CDR V2709) V2858)))
                             (IF (NULL V2710)
                              (LET ((V2711 (shen.lazyderef V2856 V2858)))
                               (IF (CONSP V2711)
                                (LET
                                 ((V2712 (shen.lazyderef (CAR V2711) V2858)))
                                 (IF (EQ 'list V2712)
                                  (LET
                                   ((V2713 (shen.lazyderef (CDR V2711) V2858)))
                                   (IF (CONSP V2713)
                                    (LET ((A (CAR V2713)))
                                     (LET
                                      ((V2714
                                        (shen.lazyderef (CDR V2713) V2858)))
                                      (IF (NULL V2714)
                                       (do (shen.incinfs)
                                        (shen.th* X A V2857 V2858
                                         (freeze
                                          (shen.th* Y (CONS 'list (CONS A NIL))
                                           V2857 V2858 V2859))))
                                       (IF
                                        (AND (ARRAYP V2714)
                                         (NOT (STRINGP V2714))
                                         (EQ (AREF V2714 0) 'shen.pvar))
                                        (do (shen.bindv V2714 NIL V2858)
                                         (LET
                                          ((Result
                                            (do (shen.incinfs)
                                             (shen.th* X A V2857 V2858
                                              (freeze
                                               (shen.th* Y
                                                (CONS 'list (CONS A NIL)) V2857
                                                V2858 V2859))))))
                                          (do (shen.unbindv V2714 V2858)
                                           Result)))
                                        'false))))
                                    (IF
                                     (AND (ARRAYP V2713) (NOT (STRINGP V2713))
                                      (EQ (AREF V2713 0) 'shen.pvar))
                                     (LET ((A (shen.newpv V2858)))
                                      (do (shen.bindv V2713 (CONS A NIL) V2858)
                                       (LET
                                        ((Result
                                          (do (shen.incinfs)
                                           (shen.th* X A V2857 V2858
                                            (freeze
                                             (shen.th* Y
                                              (CONS 'list (CONS A NIL)) V2857
                                              V2858 V2859))))))
                                        (do (shen.unbindv V2713 V2858)
                                         Result))))
                                     'false)))
                                  (IF
                                   (AND (ARRAYP V2712) (NOT (STRINGP V2712))
                                    (EQ (AREF V2712 0) 'shen.pvar))
                                   (do (shen.bindv V2712 'list V2858)
                                    (LET
                                     ((Result
                                       (LET
                                        ((V2715
                                          (shen.lazyderef (CDR V2711) V2858)))
                                        (IF (CONSP V2715)
                                         (LET ((A (CAR V2715)))
                                          (LET
                                           ((V2716
                                             (shen.lazyderef (CDR V2715)
                                              V2858)))
                                           (IF (NULL V2716)
                                            (do (shen.incinfs)
                                             (shen.th* X A V2857 V2858
                                              (freeze
                                               (shen.th* Y
                                                (CONS 'list (CONS A NIL)) V2857
                                                V2858 V2859))))
                                            (IF
                                             (AND (ARRAYP V2716)
                                              (NOT (STRINGP V2716))
                                              (EQ (AREF V2716 0) 'shen.pvar))
                                             (do (shen.bindv V2716 NIL V2858)
                                              (LET
                                               ((Result
                                                 (do (shen.incinfs)
                                                  (shen.th* X A V2857 V2858
                                                   (freeze
                                                    (shen.th* Y
                                                     (CONS 'list (CONS A NIL))
                                                     V2857 V2858 V2859))))))
                                               (do (shen.unbindv V2716 V2858)
                                                Result)))
                                             'false))))
                                         (IF
                                          (AND (ARRAYP V2715)
                                           (NOT (STRINGP V2715))
                                           (EQ (AREF V2715 0) 'shen.pvar))
                                          (LET ((A (shen.newpv V2858)))
                                           (do
                                            (shen.bindv V2715 (CONS A NIL)
                                             V2858)
                                            (LET
                                             ((Result
                                               (do (shen.incinfs)
                                                (shen.th* X A V2857 V2858
                                                 (freeze
                                                  (shen.th* Y
                                                   (CONS 'list (CONS A NIL))
                                                   V2857 V2858 V2859))))))
                                             (do (shen.unbindv V2715 V2858)
                                              Result))))
                                          'false)))))
                                     (do (shen.unbindv V2712 V2858) Result)))
                                   'false)))
                                (IF
                                 (AND (ARRAYP V2711) (NOT (STRINGP V2711))
                                  (EQ (AREF V2711 0) 'shen.pvar))
                                 (LET ((A (shen.newpv V2858)))
                                  (do
                                   (shen.bindv V2711 (CONS 'list (CONS A NIL))
                                    V2858)
                                   (LET
                                    ((Result
                                      (do (shen.incinfs)
                                       (shen.th* X A V2857 V2858
                                        (freeze
                                         (shen.th* Y (CONS 'list (CONS A NIL))
                                          V2857 V2858 V2859))))))
                                    (do (shen.unbindv V2711 V2858) Result))))
                                 'false)))
                              'false)))
                           'false)))
                        'false))
                      'false))
                    'false))))
                (IF (shen.ABSEQUAL Case 'false)
                 (LET
                  ((Case
                    (LET ((V2717 (shen.lazyderef V2855 V2858)))
                     (IF (CONSP V2717)
                      (LET ((V2718 (shen.lazyderef (CAR V2717) V2858)))
                       (IF (EQ '@p V2718)
                        (LET ((V2719 (shen.lazyderef (CDR V2717) V2858)))
                         (IF (CONSP V2719)
                          (LET ((X (CAR V2719)))
                           (LET ((V2720 (shen.lazyderef (CDR V2719) V2858)))
                            (IF (CONSP V2720)
                             (LET ((Y (CAR V2720)))
                              (LET ((V2721 (shen.lazyderef (CDR V2720) V2858)))
                               (IF (NULL V2721)
                                (LET ((V2722 (shen.lazyderef V2856 V2858)))
                                 (IF (CONSP V2722)
                                  (LET ((A (CAR V2722)))
                                   (LET
                                    ((V2723
                                      (shen.lazyderef (CDR V2722) V2858)))
                                    (IF (CONSP V2723)
                                     (LET
                                      ((V2724
                                        (shen.lazyderef (CAR V2723) V2858)))
                                      (IF (EQ '* V2724)
                                       (LET
                                        ((V2725
                                          (shen.lazyderef (CDR V2723) V2858)))
                                        (IF (CONSP V2725)
                                         (LET ((B (CAR V2725)))
                                          (LET
                                           ((V2726
                                             (shen.lazyderef (CDR V2725)
                                              V2858)))
                                           (IF (NULL V2726)
                                            (do (shen.incinfs)
                                             (shen.th* X A V2857 V2858
                                              (freeze
                                               (shen.th* Y B V2857 V2858
                                                V2859))))
                                            (IF
                                             (AND (ARRAYP V2726)
                                              (NOT (STRINGP V2726))
                                              (EQ (AREF V2726 0) 'shen.pvar))
                                             (do (shen.bindv V2726 NIL V2858)
                                              (LET
                                               ((Result
                                                 (do (shen.incinfs)
                                                  (shen.th* X A V2857 V2858
                                                   (freeze
                                                    (shen.th* Y B V2857 V2858
                                                     V2859))))))
                                               (do (shen.unbindv V2726 V2858)
                                                Result)))
                                             'false))))
                                         (IF
                                          (AND (ARRAYP V2725)
                                           (NOT (STRINGP V2725))
                                           (EQ (AREF V2725 0) 'shen.pvar))
                                          (LET ((B (shen.newpv V2858)))
                                           (do
                                            (shen.bindv V2725 (CONS B NIL)
                                             V2858)
                                            (LET
                                             ((Result
                                               (do (shen.incinfs)
                                                (shen.th* X A V2857 V2858
                                                 (freeze
                                                  (shen.th* Y B V2857 V2858
                                                   V2859))))))
                                             (do (shen.unbindv V2725 V2858)
                                              Result))))
                                          'false)))
                                       (IF
                                        (AND (ARRAYP V2724)
                                         (NOT (STRINGP V2724))
                                         (EQ (AREF V2724 0) 'shen.pvar))
                                        (do (shen.bindv V2724 '* V2858)
                                         (LET
                                          ((Result
                                            (LET
                                             ((V2727
                                               (shen.lazyderef (CDR V2723)
                                                V2858)))
                                             (IF (CONSP V2727)
                                              (LET ((B (CAR V2727)))
                                               (LET
                                                ((V2728
                                                  (shen.lazyderef (CDR V2727)
                                                   V2858)))
                                                (IF (NULL V2728)
                                                 (do (shen.incinfs)
                                                  (shen.th* X A V2857 V2858
                                                   (freeze
                                                    (shen.th* Y B V2857 V2858
                                                     V2859))))
                                                 (IF
                                                  (AND (ARRAYP V2728)
                                                   (NOT (STRINGP V2728))
                                                   (EQ (AREF V2728 0)
                                                    'shen.pvar))
                                                  (do
                                                   (shen.bindv V2728 NIL V2858)
                                                   (LET
                                                    ((Result
                                                      (do (shen.incinfs)
                                                       (shen.th* X A V2857
                                                        V2858
                                                        (freeze
                                                         (shen.th* Y B V2857
                                                          V2858 V2859))))))
                                                    (do
                                                     (shen.unbindv V2728 V2858)
                                                     Result)))
                                                  'false))))
                                              (IF
                                               (AND (ARRAYP V2727)
                                                (NOT (STRINGP V2727))
                                                (EQ (AREF V2727 0) 'shen.pvar))
                                               (LET ((B (shen.newpv V2858)))
                                                (do
                                                 (shen.bindv V2727 (CONS B NIL)
                                                  V2858)
                                                 (LET
                                                  ((Result
                                                    (do (shen.incinfs)
                                                     (shen.th* X A V2857 V2858
                                                      (freeze
                                                       (shen.th* Y B V2857
                                                        V2858 V2859))))))
                                                  (do
                                                   (shen.unbindv V2727 V2858)
                                                   Result))))
                                               'false)))))
                                          (do (shen.unbindv V2724 V2858)
                                           Result)))
                                        'false)))
                                     (IF
                                      (AND (ARRAYP V2723) (NOT (STRINGP V2723))
                                       (EQ (AREF V2723 0) 'shen.pvar))
                                      (LET ((B (shen.newpv V2858)))
                                       (do
                                        (shen.bindv V2723
                                         (CONS '* (CONS B NIL)) V2858)
                                        (LET
                                         ((Result
                                           (do (shen.incinfs)
                                            (shen.th* X A V2857 V2858
                                             (freeze
                                              (shen.th* Y B V2857 V2858
                                               V2859))))))
                                         (do (shen.unbindv V2723 V2858)
                                          Result))))
                                      'false))))
                                  (IF
                                   (AND (ARRAYP V2722) (NOT (STRINGP V2722))
                                    (EQ (AREF V2722 0) 'shen.pvar))
                                   (LET ((A (shen.newpv V2858)))
                                    (LET ((B (shen.newpv V2858)))
                                     (do
                                      (shen.bindv V2722
                                       (CONS A (CONS '* (CONS B NIL))) V2858)
                                      (LET
                                       ((Result
                                         (do (shen.incinfs)
                                          (shen.th* X A V2857 V2858
                                           (freeze
                                            (shen.th* Y B V2857 V2858
                                             V2859))))))
                                       (do (shen.unbindv V2722 V2858)
                                        Result)))))
                                   'false)))
                                'false)))
                             'false)))
                          'false))
                        'false))
                      'false))))
                  (IF (shen.ABSEQUAL Case 'false)
                   (LET
                    ((Case
                      (LET ((V2729 (shen.lazyderef V2855 V2858)))
                       (IF (CONSP V2729)
                        (LET ((V2730 (shen.lazyderef (CAR V2729) V2858)))
                         (IF (EQ '@v V2730)
                          (LET ((V2731 (shen.lazyderef (CDR V2729) V2858)))
                           (IF (CONSP V2731)
                            (LET ((X (CAR V2731)))
                             (LET ((V2732 (shen.lazyderef (CDR V2731) V2858)))
                              (IF (CONSP V2732)
                               (LET ((Y (CAR V2732)))
                                (LET
                                 ((V2733 (shen.lazyderef (CDR V2732) V2858)))
                                 (IF (NULL V2733)
                                  (LET ((V2734 (shen.lazyderef V2856 V2858)))
                                   (IF (CONSP V2734)
                                    (LET
                                     ((V2735
                                       (shen.lazyderef (CAR V2734) V2858)))
                                     (IF (EQ 'vector V2735)
                                      (LET
                                       ((V2736
                                         (shen.lazyderef (CDR V2734) V2858)))
                                       (IF (CONSP V2736)
                                        (LET ((A (CAR V2736)))
                                         (LET
                                          ((V2737
                                            (shen.lazyderef (CDR V2736)
                                             V2858)))
                                          (IF (NULL V2737)
                                           (do (shen.incinfs)
                                            (shen.th* X A V2857 V2858
                                             (freeze
                                              (shen.th* Y
                                               (CONS 'vector (CONS A NIL))
                                               V2857 V2858 V2859))))
                                           (IF
                                            (AND (ARRAYP V2737)
                                             (NOT (STRINGP V2737))
                                             (EQ (AREF V2737 0) 'shen.pvar))
                                            (do (shen.bindv V2737 NIL V2858)
                                             (LET
                                              ((Result
                                                (do (shen.incinfs)
                                                 (shen.th* X A V2857 V2858
                                                  (freeze
                                                   (shen.th* Y
                                                    (CONS 'vector (CONS A NIL))
                                                    V2857 V2858 V2859))))))
                                              (do (shen.unbindv V2737 V2858)
                                               Result)))
                                            'false))))
                                        (IF
                                         (AND (ARRAYP V2736)
                                          (NOT (STRINGP V2736))
                                          (EQ (AREF V2736 0) 'shen.pvar))
                                         (LET ((A (shen.newpv V2858)))
                                          (do
                                           (shen.bindv V2736 (CONS A NIL)
                                            V2858)
                                           (LET
                                            ((Result
                                              (do (shen.incinfs)
                                               (shen.th* X A V2857 V2858
                                                (freeze
                                                 (shen.th* Y
                                                  (CONS 'vector (CONS A NIL))
                                                  V2857 V2858 V2859))))))
                                            (do (shen.unbindv V2736 V2858)
                                             Result))))
                                         'false)))
                                      (IF
                                       (AND (ARRAYP V2735)
                                        (NOT (STRINGP V2735))
                                        (EQ (AREF V2735 0) 'shen.pvar))
                                       (do (shen.bindv V2735 'vector V2858)
                                        (LET
                                         ((Result
                                           (LET
                                            ((V2738
                                              (shen.lazyderef (CDR V2734)
                                               V2858)))
                                            (IF (CONSP V2738)
                                             (LET ((A (CAR V2738)))
                                              (LET
                                               ((V2739
                                                 (shen.lazyderef (CDR V2738)
                                                  V2858)))
                                               (IF (NULL V2739)
                                                (do (shen.incinfs)
                                                 (shen.th* X A V2857 V2858
                                                  (freeze
                                                   (shen.th* Y
                                                    (CONS 'vector (CONS A NIL))
                                                    V2857 V2858 V2859))))
                                                (IF
                                                 (AND (ARRAYP V2739)
                                                  (NOT (STRINGP V2739))
                                                  (EQ (AREF V2739 0)
                                                   'shen.pvar))
                                                 (do
                                                  (shen.bindv V2739 NIL V2858)
                                                  (LET
                                                   ((Result
                                                     (do (shen.incinfs)
                                                      (shen.th* X A V2857 V2858
                                                       (freeze
                                                        (shen.th* Y
                                                         (CONS 'vector
                                                          (CONS A NIL))
                                                         V2857 V2858
                                                         V2859))))))
                                                   (do
                                                    (shen.unbindv V2739 V2858)
                                                    Result)))
                                                 'false))))
                                             (IF
                                              (AND (ARRAYP V2738)
                                               (NOT (STRINGP V2738))
                                               (EQ (AREF V2738 0) 'shen.pvar))
                                              (LET ((A (shen.newpv V2858)))
                                               (do
                                                (shen.bindv V2738 (CONS A NIL)
                                                 V2858)
                                                (LET
                                                 ((Result
                                                   (do (shen.incinfs)
                                                    (shen.th* X A V2857 V2858
                                                     (freeze
                                                      (shen.th* Y
                                                       (CONS 'vector
                                                        (CONS A NIL))
                                                       V2857 V2858 V2859))))))
                                                 (do (shen.unbindv V2738 V2858)
                                                  Result))))
                                              'false)))))
                                         (do (shen.unbindv V2735 V2858)
                                          Result)))
                                       'false)))
                                    (IF
                                     (AND (ARRAYP V2734) (NOT (STRINGP V2734))
                                      (EQ (AREF V2734 0) 'shen.pvar))
                                     (LET ((A (shen.newpv V2858)))
                                      (do
                                       (shen.bindv V2734
                                        (CONS 'vector (CONS A NIL)) V2858)
                                       (LET
                                        ((Result
                                          (do (shen.incinfs)
                                           (shen.th* X A V2857 V2858
                                            (freeze
                                             (shen.th* Y
                                              (CONS 'vector (CONS A NIL)) V2857
                                              V2858 V2859))))))
                                        (do (shen.unbindv V2734 V2858)
                                         Result))))
                                     'false)))
                                  'false)))
                               'false)))
                            'false))
                          'false))
                        'false))))
                    (IF (shen.ABSEQUAL Case 'false)
                     (LET
                      ((Case
                        (LET ((V2740 (shen.lazyderef V2855 V2858)))
                         (IF (CONSP V2740)
                          (LET ((V2741 (shen.lazyderef (CAR V2740) V2858)))
                           (IF (EQ '@s V2741)
                            (LET ((V2742 (shen.lazyderef (CDR V2740) V2858)))
                             (IF (CONSP V2742)
                              (LET ((X (CAR V2742)))
                               (LET
                                ((V2743 (shen.lazyderef (CDR V2742) V2858)))
                                (IF (CONSP V2743)
                                 (LET ((Y (CAR V2743)))
                                  (LET
                                   ((V2744 (shen.lazyderef (CDR V2743) V2858)))
                                   (IF (NULL V2744)
                                    (LET ((V2745 (shen.lazyderef V2856 V2858)))
                                     (IF (EQ 'string V2745)
                                      (do (shen.incinfs)
                                       (shen.th* X 'string V2857 V2858
                                        (freeze
                                         (shen.th* Y 'string V2857 V2858
                                          V2859))))
                                      (IF
                                       (AND (ARRAYP V2745)
                                        (NOT (STRINGP V2745))
                                        (EQ (AREF V2745 0) 'shen.pvar))
                                       (do (shen.bindv V2745 'string V2858)
                                        (LET
                                         ((Result
                                           (do (shen.incinfs)
                                            (shen.th* X 'string V2857 V2858
                                             (freeze
                                              (shen.th* Y 'string V2857 V2858
                                               V2859))))))
                                         (do (shen.unbindv V2745 V2858)
                                          Result)))
                                       'false)))
                                    'false)))
                                 'false)))
                              'false))
                            'false))
                          'false))))
                      (IF (shen.ABSEQUAL Case 'false)
                       (LET
                        ((Case
                          (LET ((V2746 (shen.lazyderef V2855 V2858)))
                           (IF (CONSP V2746)
                            (LET ((V2747 (shen.lazyderef (CAR V2746) V2858)))
                             (IF (EQ 'lambda V2747)
                              (LET ((V2748 (shen.lazyderef (CDR V2746) V2858)))
                               (IF (CONSP V2748)
                                (LET ((X (CAR V2748)))
                                 (LET
                                  ((V2749 (shen.lazyderef (CDR V2748) V2858)))
                                  (IF (CONSP V2749)
                                   (LET ((Y (CAR V2749)))
                                    (LET
                                     ((V2750
                                       (shen.lazyderef (CDR V2749) V2858)))
                                     (IF (NULL V2750)
                                      (LET
                                       ((V2751 (shen.lazyderef V2856 V2858)))
                                       (IF (CONSP V2751)
                                        (LET ((A (CAR V2751)))
                                         (LET
                                          ((V2752
                                            (shen.lazyderef (CDR V2751)
                                             V2858)))
                                          (IF (CONSP V2752)
                                           (LET
                                            ((V2753
                                              (shen.lazyderef (CAR V2752)
                                               V2858)))
                                            (IF (EQ '--> V2753)
                                             (LET
                                              ((V2754
                                                (shen.lazyderef (CDR V2752)
                                                 V2858)))
                                              (IF (CONSP V2754)
                                               (LET ((B (CAR V2754)))
                                                (LET
                                                 ((V2755
                                                   (shen.lazyderef (CDR V2754)
                                                    V2858)))
                                                 (IF (NULL V2755)
                                                  (LET ((Z (shen.newpv V2858)))
                                                   (LET
                                                    ((X&& (shen.newpv V2858)))
                                                    (do (shen.incinfs)
                                                     (cut Throwcontrol V2858
                                                      (freeze
                                                       (bind X&&
                                                        (shen.placeholder)
                                                        V2858
                                                        (freeze
                                                         (bind Z
                                                          (shen.ebr
                                                           (shen.lazyderef X&&
                                                            V2858)
                                                           (shen.lazyderef X
                                                            V2858)
                                                           (shen.lazyderef Y
                                                            V2858))
                                                          V2858
                                                          (freeze
                                                           (shen.th* Z B
                                                            (CONS
                                                             (CONS X&&
                                                              (CONS '|:|
                                                               (CONS A NIL)))
                                                             V2857)
                                                            V2858
                                                            V2859))))))))))
                                                  (IF
                                                   (AND (ARRAYP V2755)
                                                    (NOT (STRINGP V2755))
                                                    (EQ (AREF V2755 0)
                                                     'shen.pvar))
                                                   (do
                                                    (shen.bindv V2755 NIL
                                                     V2858)
                                                    (LET
                                                     ((Result
                                                       (LET
                                                        ((Z
                                                          (shen.newpv V2858)))
                                                        (LET
                                                         ((X&&
                                                           (shen.newpv V2858)))
                                                         (do (shen.incinfs)
                                                          (cut Throwcontrol
                                                           V2858
                                                           (freeze
                                                            (bind X&&
                                                             (shen.placeholder)
                                                             V2858
                                                             (freeze
                                                              (bind Z
                                                               (shen.ebr
                                                                (shen.lazyderef
                                                                 X&& V2858)
                                                                (shen.lazyderef
                                                                 X V2858)
                                                                (shen.lazyderef
                                                                 Y V2858))
                                                               V2858
                                                               (freeze
                                                                (shen.th* Z B
                                                                 (CONS
                                                                  (CONS X&&
                                                                   (CONS '|:|
                                                                    (CONS A
                                                                     NIL)))
                                                                  V2857)
                                                                 V2858
                                                                 V2859))))))))))))
                                                     (do
                                                      (shen.unbindv V2755
                                                       V2858)
                                                      Result)))
                                                   'false))))
                                               (IF
                                                (AND (ARRAYP V2754)
                                                 (NOT (STRINGP V2754))
                                                 (EQ (AREF V2754 0)
                                                  'shen.pvar))
                                                (LET ((B (shen.newpv V2858)))
                                                 (do
                                                  (shen.bindv V2754
                                                   (CONS B NIL) V2858)
                                                  (LET
                                                   ((Result
                                                     (LET
                                                      ((Z (shen.newpv V2858)))
                                                      (LET
                                                       ((X&&
                                                         (shen.newpv V2858)))
                                                       (do (shen.incinfs)
                                                        (cut Throwcontrol V2858
                                                         (freeze
                                                          (bind X&&
                                                           (shen.placeholder)
                                                           V2858
                                                           (freeze
                                                            (bind Z
                                                             (shen.ebr
                                                              (shen.lazyderef
                                                               X&& V2858)
                                                              (shen.lazyderef X
                                                               V2858)
                                                              (shen.lazyderef Y
                                                               V2858))
                                                             V2858
                                                             (freeze
                                                              (shen.th* Z B
                                                               (CONS
                                                                (CONS X&&
                                                                 (CONS '|:|
                                                                  (CONS A
                                                                   NIL)))
                                                                V2857)
                                                               V2858
                                                               V2859))))))))))))
                                                   (do
                                                    (shen.unbindv V2754 V2858)
                                                    Result))))
                                                'false)))
                                             (IF
                                              (AND (ARRAYP V2753)
                                               (NOT (STRINGP V2753))
                                               (EQ (AREF V2753 0) 'shen.pvar))
                                              (do (shen.bindv V2753 '--> V2858)
                                               (LET
                                                ((Result
                                                  (LET
                                                   ((V2756
                                                     (shen.lazyderef
                                                      (CDR V2752) V2858)))
                                                   (IF (CONSP V2756)
                                                    (LET ((B (CAR V2756)))
                                                     (LET
                                                      ((V2757
                                                        (shen.lazyderef
                                                         (CDR V2756) V2858)))
                                                      (IF (NULL V2757)
                                                       (LET
                                                        ((Z
                                                          (shen.newpv V2858)))
                                                        (LET
                                                         ((X&&
                                                           (shen.newpv V2858)))
                                                         (do (shen.incinfs)
                                                          (cut Throwcontrol
                                                           V2858
                                                           (freeze
                                                            (bind X&&
                                                             (shen.placeholder)
                                                             V2858
                                                             (freeze
                                                              (bind Z
                                                               (shen.ebr
                                                                (shen.lazyderef
                                                                 X&& V2858)
                                                                (shen.lazyderef
                                                                 X V2858)
                                                                (shen.lazyderef
                                                                 Y V2858))
                                                               V2858
                                                               (freeze
                                                                (shen.th* Z B
                                                                 (CONS
                                                                  (CONS X&&
                                                                   (CONS '|:|
                                                                    (CONS A
                                                                     NIL)))
                                                                  V2857)
                                                                 V2858
                                                                 V2859))))))))))
                                                       (IF
                                                        (AND (ARRAYP V2757)
                                                         (NOT (STRINGP V2757))
                                                         (EQ (AREF V2757 0)
                                                          'shen.pvar))
                                                        (do
                                                         (shen.bindv V2757 NIL
                                                          V2858)
                                                         (LET
                                                          ((Result
                                                            (LET
                                                             ((Z
                                                               (shen.newpv
                                                                V2858)))
                                                             (LET
                                                              ((X&&
                                                                (shen.newpv
                                                                 V2858)))
                                                              (do
                                                               (shen.incinfs)
                                                               (cut
                                                                Throwcontrol
                                                                V2858
                                                                (freeze
                                                                 (bind X&&
                                                                  (shen.placeholder)
                                                                  V2858
                                                                  (freeze
                                                                   (bind Z
                                                                    (shen.ebr
                                                                     (shen.lazyderef
                                                                      X&&
                                                                      V2858)
                                                                     (shen.lazyderef
                                                                      X V2858)
                                                                     (shen.lazyderef
                                                                      Y V2858))
                                                                    V2858
                                                                    (freeze
                                                                     (shen.th*
                                                                      Z B
                                                                      (CONS
                                                                       (CONS
                                                                        X&&
                                                                        (CONS
                                                                         '|:|
                                                                         (CONS
                                                                          A
                                                                          NIL)))
                                                                       V2857)
                                                                      V2858
                                                                      V2859))))))))))))
                                                          (do
                                                           (shen.unbindv V2757
                                                            V2858)
                                                           Result)))
                                                        'false))))
                                                    (IF
                                                     (AND (ARRAYP V2756)
                                                      (NOT (STRINGP V2756))
                                                      (EQ (AREF V2756 0)
                                                       'shen.pvar))
                                                     (LET
                                                      ((B (shen.newpv V2858)))
                                                      (do
                                                       (shen.bindv V2756
                                                        (CONS B NIL) V2858)
                                                       (LET
                                                        ((Result
                                                          (LET
                                                           ((Z
                                                             (shen.newpv
                                                              V2858)))
                                                           (LET
                                                            ((X&&
                                                              (shen.newpv
                                                               V2858)))
                                                            (do (shen.incinfs)
                                                             (cut Throwcontrol
                                                              V2858
                                                              (freeze
                                                               (bind X&&
                                                                (shen.placeholder)
                                                                V2858
                                                                (freeze
                                                                 (bind Z
                                                                  (shen.ebr
                                                                   (shen.lazyderef
                                                                    X&& V2858)
                                                                   (shen.lazyderef
                                                                    X V2858)
                                                                   (shen.lazyderef
                                                                    Y V2858))
                                                                  V2858
                                                                  (freeze
                                                                   (shen.th* Z
                                                                    B
                                                                    (CONS
                                                                     (CONS X&&
                                                                      (CONS
                                                                       '|:|
                                                                       (CONS A
                                                                        NIL)))
                                                                     V2857)
                                                                    V2858
                                                                    V2859))))))))))))
                                                        (do
                                                         (shen.unbindv V2756
                                                          V2858)
                                                         Result))))
                                                     'false)))))
                                                (do (shen.unbindv V2753 V2858)
                                                 Result)))
                                              'false)))
                                           (IF
                                            (AND (ARRAYP V2752)
                                             (NOT (STRINGP V2752))
                                             (EQ (AREF V2752 0) 'shen.pvar))
                                            (LET ((B (shen.newpv V2858)))
                                             (do
                                              (shen.bindv V2752
                                               (CONS '--> (CONS B NIL)) V2858)
                                              (LET
                                               ((Result
                                                 (LET ((Z (shen.newpv V2858)))
                                                  (LET
                                                   ((X&& (shen.newpv V2858)))
                                                   (do (shen.incinfs)
                                                    (cut Throwcontrol V2858
                                                     (freeze
                                                      (bind X&&
                                                       (shen.placeholder) V2858
                                                       (freeze
                                                        (bind Z
                                                         (shen.ebr
                                                          (shen.lazyderef X&&
                                                           V2858)
                                                          (shen.lazyderef X
                                                           V2858)
                                                          (shen.lazyderef Y
                                                           V2858))
                                                         V2858
                                                         (freeze
                                                          (shen.th* Z B
                                                           (CONS
                                                            (CONS X&&
                                                             (CONS '|:|
                                                              (CONS A NIL)))
                                                            V2857)
                                                           V2858
                                                           V2859))))))))))))
                                               (do (shen.unbindv V2752 V2858)
                                                Result))))
                                            'false))))
                                        (IF
                                         (AND (ARRAYP V2751)
                                          (NOT (STRINGP V2751))
                                          (EQ (AREF V2751 0) 'shen.pvar))
                                         (LET ((A (shen.newpv V2858)))
                                          (LET ((B (shen.newpv V2858)))
                                           (do
                                            (shen.bindv V2751
                                             (CONS A (CONS '--> (CONS B NIL)))
                                             V2858)
                                            (LET
                                             ((Result
                                               (LET ((Z (shen.newpv V2858)))
                                                (LET ((X&& (shen.newpv V2858)))
                                                 (do (shen.incinfs)
                                                  (cut Throwcontrol V2858
                                                   (freeze
                                                    (bind X&&
                                                     (shen.placeholder) V2858
                                                     (freeze
                                                      (bind Z
                                                       (shen.ebr
                                                        (shen.lazyderef X&&
                                                         V2858)
                                                        (shen.lazyderef X
                                                         V2858)
                                                        (shen.lazyderef Y
                                                         V2858))
                                                       V2858
                                                       (freeze
                                                        (shen.th* Z B
                                                         (CONS
                                                          (CONS X&&
                                                           (CONS '|:|
                                                            (CONS A NIL)))
                                                          V2857)
                                                         V2858
                                                         V2859))))))))))))
                                             (do (shen.unbindv V2751 V2858)
                                              Result)))))
                                         'false)))
                                      'false)))
                                   'false)))
                                'false))
                              'false))
                            'false))))
                        (IF (shen.ABSEQUAL Case 'false)
                         (LET
                          ((Case
                            (LET ((V2758 (shen.lazyderef V2855 V2858)))
                             (IF (CONSP V2758)
                              (LET ((V2759 (shen.lazyderef (CAR V2758) V2858)))
                               (IF (EQ 'let V2759)
                                (LET
                                 ((V2760 (shen.lazyderef (CDR V2758) V2858)))
                                 (IF (CONSP V2760)
                                  (LET ((X (CAR V2760)))
                                   (LET
                                    ((V2761
                                      (shen.lazyderef (CDR V2760) V2858)))
                                    (IF (CONSP V2761)
                                     (LET ((Y (CAR V2761)))
                                      (LET
                                       ((V2762
                                         (shen.lazyderef (CDR V2761) V2858)))
                                       (IF (CONSP V2762)
                                        (LET ((Z (CAR V2762)))
                                         (LET
                                          ((V2763
                                            (shen.lazyderef (CDR V2762)
                                             V2858)))
                                          (IF (NULL V2763)
                                           (LET ((W (shen.newpv V2858)))
                                            (LET ((X&& (shen.newpv V2858)))
                                             (LET ((B (shen.newpv V2858)))
                                              (do (shen.incinfs)
                                               (shen.th* Y B V2857 V2858
                                                (freeze
                                                 (bind X&& (shen.placeholder)
                                                  V2858
                                                  (freeze
                                                   (bind W
                                                    (shen.ebr
                                                     (shen.lazyderef X&& V2858)
                                                     (shen.lazyderef X V2858)
                                                     (shen.lazyderef Z V2858))
                                                    V2858
                                                    (freeze
                                                     (shen.th* W V2856
                                                      (CONS
                                                       (CONS X&&
                                                        (CONS '|:|
                                                         (CONS B NIL)))
                                                       V2857)
                                                      V2858 V2859)))))))))))
                                           'false)))
                                        'false)))
                                     'false)))
                                  'false))
                                'false))
                              'false))))
                          (IF (shen.ABSEQUAL Case 'false)
                           (LET
                            ((Case
                              (LET ((V2764 (shen.lazyderef V2855 V2858)))
                               (IF (CONSP V2764)
                                (LET
                                 ((V2765 (shen.lazyderef (CAR V2764) V2858)))
                                 (IF (EQ 'open V2765)
                                  (LET
                                   ((V2766 (shen.lazyderef (CDR V2764) V2858)))
                                   (IF (CONSP V2766)
                                    (LET ((FileName (CAR V2766)))
                                     (LET
                                      ((V2767
                                        (shen.lazyderef (CDR V2766) V2858)))
                                      (IF (CONSP V2767)
                                       (LET ((Direction2697 (CAR V2767)))
                                        (LET
                                         ((V2768
                                           (shen.lazyderef (CDR V2767) V2858)))
                                         (IF (NULL V2768)
                                          (LET
                                           ((V2769
                                             (shen.lazyderef V2856 V2858)))
                                           (IF (CONSP V2769)
                                            (LET
                                             ((V2770
                                               (shen.lazyderef (CAR V2769)
                                                V2858)))
                                             (IF (EQ 'stream V2770)
                                              (LET
                                               ((V2771
                                                 (shen.lazyderef (CDR V2769)
                                                  V2858)))
                                               (IF (CONSP V2771)
                                                (LET ((Direction (CAR V2771)))
                                                 (LET
                                                  ((V2772
                                                    (shen.lazyderef (CDR V2771)
                                                     V2858)))
                                                  (IF (NULL V2772)
                                                   (do (shen.incinfs)
                                                    (unify! Direction
                                                     Direction2697 V2858
                                                     (freeze
                                                      (cut Throwcontrol V2858
                                                       (freeze
                                                        (shen.th* FileName
                                                         'string V2857 V2858
                                                         V2859))))))
                                                   (IF
                                                    (AND (ARRAYP V2772)
                                                     (NOT (STRINGP V2772))
                                                     (EQ (AREF V2772 0)
                                                      'shen.pvar))
                                                    (do
                                                     (shen.bindv V2772 NIL
                                                      V2858)
                                                     (LET
                                                      ((Result
                                                        (do (shen.incinfs)
                                                         (unify! Direction
                                                          Direction2697 V2858
                                                          (freeze
                                                           (cut Throwcontrol
                                                            V2858
                                                            (freeze
                                                             (shen.th* FileName
                                                              'string V2857
                                                              V2858
                                                              V2859))))))))
                                                      (do
                                                       (shen.unbindv V2772
                                                        V2858)
                                                       Result)))
                                                    'false))))
                                                (IF
                                                 (AND (ARRAYP V2771)
                                                  (NOT (STRINGP V2771))
                                                  (EQ (AREF V2771 0)
                                                   'shen.pvar))
                                                 (LET
                                                  ((Direction
                                                    (shen.newpv V2858)))
                                                  (do
                                                   (shen.bindv V2771
                                                    (CONS Direction NIL) V2858)
                                                   (LET
                                                    ((Result
                                                      (do (shen.incinfs)
                                                       (unify! Direction
                                                        Direction2697 V2858
                                                        (freeze
                                                         (cut Throwcontrol
                                                          V2858
                                                          (freeze
                                                           (shen.th* FileName
                                                            'string V2857 V2858
                                                            V2859))))))))
                                                    (do
                                                     (shen.unbindv V2771 V2858)
                                                     Result))))
                                                 'false)))
                                              (IF
                                               (AND (ARRAYP V2770)
                                                (NOT (STRINGP V2770))
                                                (EQ (AREF V2770 0) 'shen.pvar))
                                               (do
                                                (shen.bindv V2770 'stream
                                                 V2858)
                                                (LET
                                                 ((Result
                                                   (LET
                                                    ((V2773
                                                      (shen.lazyderef
                                                       (CDR V2769) V2858)))
                                                    (IF (CONSP V2773)
                                                     (LET
                                                      ((Direction (CAR V2773)))
                                                      (LET
                                                       ((V2774
                                                         (shen.lazyderef
                                                          (CDR V2773) V2858)))
                                                       (IF (NULL V2774)
                                                        (do (shen.incinfs)
                                                         (unify! Direction
                                                          Direction2697 V2858
                                                          (freeze
                                                           (cut Throwcontrol
                                                            V2858
                                                            (freeze
                                                             (shen.th* FileName
                                                              'string V2857
                                                              V2858 V2859))))))
                                                        (IF
                                                         (AND (ARRAYP V2774)
                                                          (NOT (STRINGP V2774))
                                                          (EQ (AREF V2774 0)
                                                           'shen.pvar))
                                                         (do
                                                          (shen.bindv V2774 NIL
                                                           V2858)
                                                          (LET
                                                           ((Result
                                                             (do (shen.incinfs)
                                                              (unify! Direction
                                                               Direction2697
                                                               V2858
                                                               (freeze
                                                                (cut
                                                                 Throwcontrol
                                                                 V2858
                                                                 (freeze
                                                                  (shen.th*
                                                                   FileName
                                                                   'string
                                                                   V2857 V2858
                                                                   V2859))))))))
                                                           (do
                                                            (shen.unbindv V2774
                                                             V2858)
                                                            Result)))
                                                         'false))))
                                                     (IF
                                                      (AND (ARRAYP V2773)
                                                       (NOT (STRINGP V2773))
                                                       (EQ (AREF V2773 0)
                                                        'shen.pvar))
                                                      (LET
                                                       ((Direction
                                                         (shen.newpv V2858)))
                                                       (do
                                                        (shen.bindv V2773
                                                         (CONS Direction NIL)
                                                         V2858)
                                                        (LET
                                                         ((Result
                                                           (do (shen.incinfs)
                                                            (unify! Direction
                                                             Direction2697
                                                             V2858
                                                             (freeze
                                                              (cut Throwcontrol
                                                               V2858
                                                               (freeze
                                                                (shen.th*
                                                                 FileName
                                                                 'string V2857
                                                                 V2858
                                                                 V2859))))))))
                                                         (do
                                                          (shen.unbindv V2773
                                                           V2858)
                                                          Result))))
                                                      'false)))))
                                                 (do (shen.unbindv V2770 V2858)
                                                  Result)))
                                               'false)))
                                            (IF
                                             (AND (ARRAYP V2769)
                                              (NOT (STRINGP V2769))
                                              (EQ (AREF V2769 0) 'shen.pvar))
                                             (LET
                                              ((Direction (shen.newpv V2858)))
                                              (do
                                               (shen.bindv V2769
                                                (CONS 'stream
                                                 (CONS Direction NIL))
                                                V2858)
                                               (LET
                                                ((Result
                                                  (do (shen.incinfs)
                                                   (unify! Direction
                                                    Direction2697 V2858
                                                    (freeze
                                                     (cut Throwcontrol V2858
                                                      (freeze
                                                       (shen.th* FileName
                                                        'string V2857 V2858
                                                        V2859))))))))
                                                (do (shen.unbindv V2769 V2858)
                                                 Result))))
                                             'false)))
                                          'false)))
                                       'false)))
                                    'false))
                                  'false))
                                'false))))
                            (IF (shen.ABSEQUAL Case 'false)
                             (LET
                              ((Case
                                (LET ((V2775 (shen.lazyderef V2855 V2858)))
                                 (IF (CONSP V2775)
                                  (LET
                                   ((V2776 (shen.lazyderef (CAR V2775) V2858)))
                                   (IF (EQ 'type V2776)
                                    (LET
                                     ((V2777
                                       (shen.lazyderef (CDR V2775) V2858)))
                                     (IF (CONSP V2777)
                                      (LET ((X (CAR V2777)))
                                       (LET
                                        ((V2778
                                          (shen.lazyderef (CDR V2777) V2858)))
                                        (IF (CONSP V2778)
                                         (LET ((A (CAR V2778)))
                                          (LET
                                           ((V2779
                                             (shen.lazyderef (CDR V2778)
                                              V2858)))
                                           (IF (NULL V2779)
                                            (do (shen.incinfs)
                                             (cut Throwcontrol V2858
                                              (freeze
                                               (unify A V2856 V2858
                                                (freeze
                                                 (shen.th* X A V2857 V2858
                                                  V2859))))))
                                            'false)))
                                         'false)))
                                      'false))
                                    'false))
                                  'false))))
                              (IF (shen.ABSEQUAL Case 'false)
                               (LET
                                ((Case
                                  (LET ((V2780 (shen.lazyderef V2855 V2858)))
                                   (IF (CONSP V2780)
                                    (LET
                                     ((V2781
                                       (shen.lazyderef (CAR V2780) V2858)))
                                     (IF (EQ 'input+ V2781)
                                      (LET
                                       ((V2782
                                         (shen.lazyderef (CDR V2780) V2858)))
                                       (IF (CONSP V2782)
                                        (LET ((A (CAR V2782)))
                                         (LET
                                          ((V2783
                                            (shen.lazyderef (CDR V2782)
                                             V2858)))
                                          (IF (CONSP V2783)
                                           (LET ((Stream (CAR V2783)))
                                            (LET
                                             ((V2784
                                               (shen.lazyderef (CDR V2783)
                                                V2858)))
                                             (IF (NULL V2784)
                                              (LET ((C (shen.newpv V2858)))
                                               (do (shen.incinfs)
                                                (bind C
                                                 (shen.demodulate
                                                  (shen.lazyderef A V2858))
                                                 V2858
                                                 (freeze
                                                  (unify V2856 C V2858
                                                   (freeze
                                                    (shen.th* Stream
                                                     (CONS 'stream
                                                      (CONS 'in NIL))
                                                     V2857 V2858 V2859)))))))
                                              'false)))
                                           'false)))
                                        'false))
                                      'false))
                                    'false))))
                                (IF (shen.ABSEQUAL Case 'false)
                                 (LET
                                  ((Case
                                    (LET ((V2785 (shen.lazyderef V2855 V2858)))
                                     (IF (CONSP V2785)
                                      (LET
                                       ((V2786
                                         (shen.lazyderef (CAR V2785) V2858)))
                                       (IF (EQ 'set V2786)
                                        (LET
                                         ((V2787
                                           (shen.lazyderef (CDR V2785) V2858)))
                                         (IF (CONSP V2787)
                                          (LET ((Var (CAR V2787)))
                                           (LET
                                            ((V2788
                                              (shen.lazyderef (CDR V2787)
                                               V2858)))
                                            (IF (CONSP V2788)
                                             (LET ((Val (CAR V2788)))
                                              (LET
                                               ((V2789
                                                 (shen.lazyderef (CDR V2788)
                                                  V2858)))
                                               (IF (NULL V2789)
                                                (do (shen.incinfs)
                                                 (cut Throwcontrol V2858
                                                  (freeze
                                                   (shen.th* Var 'symbol V2857
                                                    V2858
                                                    (freeze
                                                     (cut Throwcontrol V2858
                                                      (freeze
                                                       (shen.th*
                                                        (CONS 'value
                                                         (CONS Var NIL))
                                                        V2856 V2857 V2858
                                                        (freeze
                                                         (shen.th* Val V2856
                                                          V2857 V2858
                                                          V2859))))))))))
                                                'false)))
                                             'false)))
                                          'false))
                                        'false))
                                      'false))))
                                  (IF (shen.ABSEQUAL Case 'false)
                                   (LET
                                    ((Case
                                      (LET
                                       ((V2790 (shen.lazyderef V2855 V2858)))
                                       (IF (CONSP V2790)
                                        (LET
                                         ((V2791
                                           (shen.lazyderef (CAR V2790) V2858)))
                                         (IF (EQ 'shen.<-sem V2791)
                                          (LET
                                           ((V2792
                                             (shen.lazyderef (CDR V2790)
                                              V2858)))
                                           (IF (CONSP V2792)
                                            (LET ((F (CAR V2792)))
                                             (LET
                                              ((V2793
                                                (shen.lazyderef (CDR V2792)
                                                 V2858)))
                                              (IF (NULL V2793)
                                               (LET ((A (shen.newpv V2858)))
                                                (LET ((F&& (shen.newpv V2858)))
                                                 (LET ((B (shen.newpv V2858)))
                                                  (do (shen.incinfs)
                                                   (cut Throwcontrol V2858
                                                    (freeze
                                                     (shen.th* F
                                                      (CONS A
                                                       (CONS '==>
                                                        (CONS B NIL)))
                                                      V2857 V2858
                                                      (freeze
                                                       (cut Throwcontrol V2858
                                                        (freeze
                                                         (bind F&&
                                                          (concat '&&
                                                           (shen.lazyderef F
                                                            V2858))
                                                          V2858
                                                          (freeze
                                                           (cut Throwcontrol
                                                            V2858
                                                            (freeze
                                                             (shen.th* F&&
                                                              V2856
                                                              (CONS
                                                               (CONS F&&
                                                                (CONS '|:|
                                                                 (CONS B NIL)))
                                                               V2857)
                                                              V2858
                                                              V2859)))))))))))))))
                                               'false)))
                                            'false))
                                          'false))
                                        'false))))
                                    (IF (shen.ABSEQUAL Case 'false)
                                     (LET
                                      ((Case
                                        (LET
                                         ((V2794 (shen.lazyderef V2855 V2858)))
                                         (IF (CONSP V2794)
                                          (LET
                                           ((V2795
                                             (shen.lazyderef (CAR V2794)
                                              V2858)))
                                           (IF (EQ 'fail V2795)
                                            (LET
                                             ((V2796
                                               (shen.lazyderef (CDR V2794)
                                                V2858)))
                                             (IF (NULL V2796)
                                              (LET
                                               ((V2797
                                                 (shen.lazyderef V2856 V2858)))
                                               (IF (EQ 'symbol V2797)
                                                (do (shen.incinfs)
                                                 (thaw V2859))
                                                (IF
                                                 (AND (ARRAYP V2797)
                                                  (NOT (STRINGP V2797))
                                                  (EQ (AREF V2797 0)
                                                   'shen.pvar))
                                                 (do
                                                  (shen.bindv V2797 'symbol
                                                   V2858)
                                                  (LET
                                                   ((Result
                                                     (do (shen.incinfs)
                                                      (thaw V2859))))
                                                   (do
                                                    (shen.unbindv V2797 V2858)
                                                    Result)))
                                                 'false)))
                                              'false))
                                            'false))
                                          'false))))
                                      (IF (shen.ABSEQUAL Case 'false)
                                       (LET
                                        ((Case
                                          (LET ((NewHyp (shen.newpv V2858)))
                                           (do (shen.incinfs)
                                            (shen.t*-hyps V2857 NewHyp V2858
                                             (freeze
                                              (shen.th* V2855 V2856 NewHyp
                                               V2858 V2859)))))))
                                        (IF (shen.ABSEQUAL Case 'false)
                                         (LET
                                          ((Case
                                            (LET
                                             ((V2798
                                               (shen.lazyderef V2855 V2858)))
                                             (IF (CONSP V2798)
                                              (LET
                                               ((V2799
                                                 (shen.lazyderef (CAR V2798)
                                                  V2858)))
                                               (IF (EQ 'define V2799)
                                                (LET
                                                 ((V2800
                                                   (shen.lazyderef (CDR V2798)
                                                    V2858)))
                                                 (IF (CONSP V2800)
                                                  (LET ((F (CAR V2800)))
                                                   (LET ((X (CDR V2800)))
                                                    (do (shen.incinfs)
                                                     (cut Throwcontrol V2858
                                                      (freeze
                                                       (shen.t*-def
                                                        (CONS 'define
                                                         (CONS F X))
                                                        V2856 V2857 V2858
                                                        V2859))))))
                                                  'false))
                                                'false))
                                              'false))))
                                          (IF (shen.ABSEQUAL Case 'false)
                                           (LET
                                            ((Case
                                              (LET
                                               ((V2801
                                                 (shen.lazyderef V2855 V2858)))
                                               (IF (CONSP V2801)
                                                (LET
                                                 ((V2802
                                                   (shen.lazyderef (CAR V2801)
                                                    V2858)))
                                                 (IF (EQ 'defcc V2802)
                                                  (LET
                                                   ((V2803
                                                     (shen.lazyderef
                                                      (CDR V2801) V2858)))
                                                   (IF (CONSP V2803)
                                                    (LET ((F (CAR V2803)))
                                                     (LET ((X (CDR V2803)))
                                                      (do (shen.incinfs)
                                                       (cut Throwcontrol V2858
                                                        (freeze
                                                         (shen.t*-defcc
                                                          (CONS 'defcc
                                                           (CONS F X))
                                                          V2856 V2857 V2858
                                                          V2859))))))
                                                    'false))
                                                  'false))
                                                'false))))
                                            (IF (shen.ABSEQUAL Case 'false)
                                             (LET
                                              ((Case
                                                (LET
                                                 ((V2804
                                                   (shen.lazyderef V2855
                                                    V2858)))
                                                 (IF (CONSP V2804)
                                                  (LET
                                                   ((V2805
                                                     (shen.lazyderef
                                                      (CAR V2804) V2858)))
                                                   (IF (EQ 'defmacro V2805)
                                                    (LET
                                                     ((V2806
                                                       (shen.lazyderef V2856
                                                        V2858)))
                                                     (IF (EQ 'unit V2806)
                                                      (do (shen.incinfs)
                                                       (cut Throwcontrol V2858
                                                        V2859))
                                                      (IF
                                                       (AND (ARRAYP V2806)
                                                        (NOT (STRINGP V2806))
                                                        (EQ (AREF V2806 0)
                                                         'shen.pvar))
                                                       (do
                                                        (shen.bindv V2806 'unit
                                                         V2858)
                                                        (LET
                                                         ((Result
                                                           (do (shen.incinfs)
                                                            (cut Throwcontrol
                                                             V2858 V2859))))
                                                         (do
                                                          (shen.unbindv V2806
                                                           V2858)
                                                          Result)))
                                                       'false)))
                                                    'false))
                                                  'false))))
                                              (IF (shen.ABSEQUAL Case 'false)
                                               (LET
                                                ((Case
                                                  (LET
                                                   ((V2807
                                                     (shen.lazyderef V2855
                                                      V2858)))
                                                   (IF (CONSP V2807)
                                                    (LET
                                                     ((V2808
                                                       (shen.lazyderef
                                                        (CAR V2807) V2858)))
                                                     (IF
                                                      (EQ
                                                       'shen.process-datatype
                                                       V2808)
                                                      (LET
                                                       ((V2809
                                                         (shen.lazyderef V2856
                                                          V2858)))
                                                       (IF (EQ 'symbol V2809)
                                                        (do (shen.incinfs)
                                                         (thaw V2859))
                                                        (IF
                                                         (AND (ARRAYP V2809)
                                                          (NOT (STRINGP V2809))
                                                          (EQ (AREF V2809 0)
                                                           'shen.pvar))
                                                         (do
                                                          (shen.bindv V2809
                                                           'symbol V2858)
                                                          (LET
                                                           ((Result
                                                             (do (shen.incinfs)
                                                              (thaw V2859))))
                                                           (do
                                                            (shen.unbindv V2809
                                                             V2858)
                                                            Result)))
                                                         'false)))
                                                      'false))
                                                    'false))))
                                                (IF (shen.ABSEQUAL Case 'false)
                                                 (LET
                                                  ((Case
                                                    (LET
                                                     ((V2810
                                                       (shen.lazyderef V2855
                                                        V2858)))
                                                     (IF (CONSP V2810)
                                                      (LET
                                                       ((V2811
                                                         (shen.lazyderef
                                                          (CAR V2810) V2858)))
                                                       (IF
                                                        (EQ 'shen.synonyms-help
                                                         V2811)
                                                        (LET
                                                         ((V2812
                                                           (shen.lazyderef
                                                            V2856 V2858)))
                                                         (IF (EQ 'symbol V2812)
                                                          (do (shen.incinfs)
                                                           (thaw V2859))
                                                          (IF
                                                           (AND (ARRAYP V2812)
                                                            (NOT
                                                             (STRINGP V2812))
                                                            (EQ (AREF V2812 0)
                                                             'shen.pvar))
                                                           (do
                                                            (shen.bindv V2812
                                                             'symbol V2858)
                                                            (LET
                                                             ((Result
                                                               (do
                                                                (shen.incinfs)
                                                                (thaw V2859))))
                                                             (do
                                                              (shen.unbindv
                                                               V2812 V2858)
                                                              Result)))
                                                           'false)))
                                                        'false))
                                                      'false))))
                                                  (IF
                                                   (shen.ABSEQUAL Case 'false)
                                                   (LET
                                                    ((Datatypes
                                                      (shen.newpv V2858)))
                                                    (do (shen.incinfs)
                                                     (bind Datatypes
                                                      shen.*datatypes* V2858
                                                      (freeze
                                                       (shen.udefs*
                                                        (CONS V2855
                                                         (CONS '|:|
                                                          (CONS V2856 NIL)))
                                                        V2857 Datatypes V2858
                                                        V2859)))))
                                                   Case))
                                                 Case))
                                               Case))
                                             Case))
                                           Case))
                                         Case))
                                       Case))
                                     Case))
                                   Case))
                                 Case))
                               Case))
                             Case))
                           Case))
                         Case))
                       Case))
                     Case))
                   Case))
                 Case))
               Case))
             Case))
           Case))
         Case))
       Case))
     Case)))))

(DEFUN shen.t*-hyps (V2860 V2861 V2862 V2863)
 (LET
  ((Case
    (LET ((V2612 (shen.lazyderef V2860 V2862)))
     (IF (CONSP V2612)
      (LET ((V2613 (shen.lazyderef (CAR V2612) V2862)))
       (IF (CONSP V2613)
        (LET ((V2614 (shen.lazyderef (CAR V2613) V2862)))
         (IF (CONSP V2614)
          (LET ((V2615 (shen.lazyderef (CAR V2614) V2862)))
           (IF (EQ 'cons V2615)
            (LET ((V2616 (shen.lazyderef (CDR V2614) V2862)))
             (IF (CONSP V2616)
              (LET ((X (CAR V2616)))
               (LET ((V2617 (shen.lazyderef (CDR V2616) V2862)))
                (IF (CONSP V2617)
                 (LET ((Y (CAR V2617)))
                  (LET ((V2618 (shen.lazyderef (CDR V2617) V2862)))
                   (IF (NULL V2618)
                    (LET ((V2619 (shen.lazyderef (CDR V2613) V2862)))
                     (IF (CONSP V2619)
                      (LET ((V2620 (shen.lazyderef (CAR V2619) V2862)))
                       (IF (EQ '|:| V2620)
                        (LET ((V2621 (shen.lazyderef (CDR V2619) V2862)))
                         (IF (CONSP V2621)
                          (LET ((V2622 (shen.lazyderef (CAR V2621) V2862)))
                           (IF (CONSP V2622)
                            (LET ((V2623 (shen.lazyderef (CAR V2622) V2862)))
                             (IF (EQ 'list V2623)
                              (LET ((V2624 (shen.lazyderef (CDR V2622) V2862)))
                               (IF (CONSP V2624)
                                (LET ((A (CAR V2624)))
                                 (LET
                                  ((V2625 (shen.lazyderef (CDR V2624) V2862)))
                                  (IF (NULL V2625)
                                   (LET
                                    ((V2626
                                      (shen.lazyderef (CDR V2621) V2862)))
                                    (IF (NULL V2626)
                                     (LET ((Hyp (CDR V2612)))
                                      (do (shen.incinfs)
                                       (bind V2861
                                        (CONS
                                         (CONS (shen.lazyderef X V2862)
                                          (CONS '|:|
                                           (CONS (shen.lazyderef A V2862)
                                            NIL)))
                                         (CONS
                                          (CONS (shen.lazyderef Y V2862)
                                           (CONS '|:|
                                            (CONS
                                             (CONS 'list
                                              (CONS (shen.lazyderef A V2862)
                                               NIL))
                                             NIL)))
                                          (shen.lazyderef Hyp V2862)))
                                        V2862 V2863)))
                                     (IF
                                      (AND (ARRAYP V2626) (NOT (STRINGP V2626))
                                       (EQ (AREF V2626 0) 'shen.pvar))
                                      (do (shen.bindv V2626 NIL V2862)
                                       (LET
                                        ((Result
                                          (LET ((Hyp (CDR V2612)))
                                           (do (shen.incinfs)
                                            (bind V2861
                                             (CONS
                                              (CONS (shen.lazyderef X V2862)
                                               (CONS '|:|
                                                (CONS (shen.lazyderef A V2862)
                                                 NIL)))
                                              (CONS
                                               (CONS (shen.lazyderef Y V2862)
                                                (CONS '|:|
                                                 (CONS
                                                  (CONS 'list
                                                   (CONS
                                                    (shen.lazyderef A V2862)
                                                    NIL))
                                                  NIL)))
                                               (shen.lazyderef Hyp V2862)))
                                             V2862 V2863)))))
                                        (do (shen.unbindv V2626 V2862)
                                         Result)))
                                      'false)))
                                   (IF
                                    (AND (ARRAYP V2625) (NOT (STRINGP V2625))
                                     (EQ (AREF V2625 0) 'shen.pvar))
                                    (do (shen.bindv V2625 NIL V2862)
                                     (LET
                                      ((Result
                                        (LET
                                         ((V2627
                                           (shen.lazyderef (CDR V2621) V2862)))
                                         (IF (NULL V2627)
                                          (LET ((Hyp (CDR V2612)))
                                           (do (shen.incinfs)
                                            (bind V2861
                                             (CONS
                                              (CONS (shen.lazyderef X V2862)
                                               (CONS '|:|
                                                (CONS (shen.lazyderef A V2862)
                                                 NIL)))
                                              (CONS
                                               (CONS (shen.lazyderef Y V2862)
                                                (CONS '|:|
                                                 (CONS
                                                  (CONS 'list
                                                   (CONS
                                                    (shen.lazyderef A V2862)
                                                    NIL))
                                                  NIL)))
                                               (shen.lazyderef Hyp V2862)))
                                             V2862 V2863)))
                                          (IF
                                           (AND (ARRAYP V2627)
                                            (NOT (STRINGP V2627))
                                            (EQ (AREF V2627 0) 'shen.pvar))
                                           (do (shen.bindv V2627 NIL V2862)
                                            (LET
                                             ((Result
                                               (LET ((Hyp (CDR V2612)))
                                                (do (shen.incinfs)
                                                 (bind V2861
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef X V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (shen.lazyderef A V2862)
                                                      NIL)))
                                                   (CONS
                                                    (CONS
                                                     (shen.lazyderef Y V2862)
                                                     (CONS '|:|
                                                      (CONS
                                                       (CONS 'list
                                                        (CONS
                                                         (shen.lazyderef A
                                                          V2862)
                                                         NIL))
                                                       NIL)))
                                                    (shen.lazyderef Hyp
                                                     V2862)))
                                                  V2862 V2863)))))
                                             (do (shen.unbindv V2627 V2862)
                                              Result)))
                                           'false)))))
                                      (do (shen.unbindv V2625 V2862) Result)))
                                    'false))))
                                (IF
                                 (AND (ARRAYP V2624) (NOT (STRINGP V2624))
                                  (EQ (AREF V2624 0) 'shen.pvar))
                                 (LET ((A (shen.newpv V2862)))
                                  (do (shen.bindv V2624 (CONS A NIL) V2862)
                                   (LET
                                    ((Result
                                      (LET
                                       ((V2628
                                         (shen.lazyderef (CDR V2621) V2862)))
                                       (IF (NULL V2628)
                                        (LET ((Hyp (CDR V2612)))
                                         (do (shen.incinfs)
                                          (bind V2861
                                           (CONS
                                            (CONS (shen.lazyderef X V2862)
                                             (CONS '|:|
                                              (CONS (shen.lazyderef A V2862)
                                               NIL)))
                                            (CONS
                                             (CONS (shen.lazyderef Y V2862)
                                              (CONS '|:|
                                               (CONS
                                                (CONS 'list
                                                 (CONS (shen.lazyderef A V2862)
                                                  NIL))
                                                NIL)))
                                             (shen.lazyderef Hyp V2862)))
                                           V2862 V2863)))
                                        (IF
                                         (AND (ARRAYP V2628)
                                          (NOT (STRINGP V2628))
                                          (EQ (AREF V2628 0) 'shen.pvar))
                                         (do (shen.bindv V2628 NIL V2862)
                                          (LET
                                           ((Result
                                             (LET ((Hyp (CDR V2612)))
                                              (do (shen.incinfs)
                                               (bind V2861
                                                (CONS
                                                 (CONS (shen.lazyderef X V2862)
                                                  (CONS '|:|
                                                   (CONS
                                                    (shen.lazyderef A V2862)
                                                    NIL)))
                                                 (CONS
                                                  (CONS
                                                   (shen.lazyderef Y V2862)
                                                   (CONS '|:|
                                                    (CONS
                                                     (CONS 'list
                                                      (CONS
                                                       (shen.lazyderef A V2862)
                                                       NIL))
                                                     NIL)))
                                                  (shen.lazyderef Hyp V2862)))
                                                V2862 V2863)))))
                                           (do (shen.unbindv V2628 V2862)
                                            Result)))
                                         'false)))))
                                    (do (shen.unbindv V2624 V2862) Result))))
                                 'false)))
                              (IF
                               (AND (ARRAYP V2623) (NOT (STRINGP V2623))
                                (EQ (AREF V2623 0) 'shen.pvar))
                               (do (shen.bindv V2623 'list V2862)
                                (LET
                                 ((Result
                                   (LET
                                    ((V2629
                                      (shen.lazyderef (CDR V2622) V2862)))
                                    (IF (CONSP V2629)
                                     (LET ((A (CAR V2629)))
                                      (LET
                                       ((V2630
                                         (shen.lazyderef (CDR V2629) V2862)))
                                       (IF (NULL V2630)
                                        (LET
                                         ((V2631
                                           (shen.lazyderef (CDR V2621) V2862)))
                                         (IF (NULL V2631)
                                          (LET ((Hyp (CDR V2612)))
                                           (do (shen.incinfs)
                                            (bind V2861
                                             (CONS
                                              (CONS (shen.lazyderef X V2862)
                                               (CONS '|:|
                                                (CONS (shen.lazyderef A V2862)
                                                 NIL)))
                                              (CONS
                                               (CONS (shen.lazyderef Y V2862)
                                                (CONS '|:|
                                                 (CONS
                                                  (CONS 'list
                                                   (CONS
                                                    (shen.lazyderef A V2862)
                                                    NIL))
                                                  NIL)))
                                               (shen.lazyderef Hyp V2862)))
                                             V2862 V2863)))
                                          (IF
                                           (AND (ARRAYP V2631)
                                            (NOT (STRINGP V2631))
                                            (EQ (AREF V2631 0) 'shen.pvar))
                                           (do (shen.bindv V2631 NIL V2862)
                                            (LET
                                             ((Result
                                               (LET ((Hyp (CDR V2612)))
                                                (do (shen.incinfs)
                                                 (bind V2861
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef X V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (shen.lazyderef A V2862)
                                                      NIL)))
                                                   (CONS
                                                    (CONS
                                                     (shen.lazyderef Y V2862)
                                                     (CONS '|:|
                                                      (CONS
                                                       (CONS 'list
                                                        (CONS
                                                         (shen.lazyderef A
                                                          V2862)
                                                         NIL))
                                                       NIL)))
                                                    (shen.lazyderef Hyp
                                                     V2862)))
                                                  V2862 V2863)))))
                                             (do (shen.unbindv V2631 V2862)
                                              Result)))
                                           'false)))
                                        (IF
                                         (AND (ARRAYP V2630)
                                          (NOT (STRINGP V2630))
                                          (EQ (AREF V2630 0) 'shen.pvar))
                                         (do (shen.bindv V2630 NIL V2862)
                                          (LET
                                           ((Result
                                             (LET
                                              ((V2632
                                                (shen.lazyderef (CDR V2621)
                                                 V2862)))
                                              (IF (NULL V2632)
                                               (LET ((Hyp (CDR V2612)))
                                                (do (shen.incinfs)
                                                 (bind V2861
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef X V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (shen.lazyderef A V2862)
                                                      NIL)))
                                                   (CONS
                                                    (CONS
                                                     (shen.lazyderef Y V2862)
                                                     (CONS '|:|
                                                      (CONS
                                                       (CONS 'list
                                                        (CONS
                                                         (shen.lazyderef A
                                                          V2862)
                                                         NIL))
                                                       NIL)))
                                                    (shen.lazyderef Hyp
                                                     V2862)))
                                                  V2862 V2863)))
                                               (IF
                                                (AND (ARRAYP V2632)
                                                 (NOT (STRINGP V2632))
                                                 (EQ (AREF V2632 0)
                                                  'shen.pvar))
                                                (do
                                                 (shen.bindv V2632 NIL V2862)
                                                 (LET
                                                  ((Result
                                                    (LET ((Hyp (CDR V2612)))
                                                     (do (shen.incinfs)
                                                      (bind V2861
                                                       (CONS
                                                        (CONS
                                                         (shen.lazyderef X
                                                          V2862)
                                                         (CONS '|:|
                                                          (CONS
                                                           (shen.lazyderef A
                                                            V2862)
                                                           NIL)))
                                                        (CONS
                                                         (CONS
                                                          (shen.lazyderef Y
                                                           V2862)
                                                          (CONS '|:|
                                                           (CONS
                                                            (CONS 'list
                                                             (CONS
                                                              (shen.lazyderef A
                                                               V2862)
                                                              NIL))
                                                            NIL)))
                                                         (shen.lazyderef Hyp
                                                          V2862)))
                                                       V2862 V2863)))))
                                                  (do
                                                   (shen.unbindv V2632 V2862)
                                                   Result)))
                                                'false)))))
                                           (do (shen.unbindv V2630 V2862)
                                            Result)))
                                         'false))))
                                     (IF
                                      (AND (ARRAYP V2629) (NOT (STRINGP V2629))
                                       (EQ (AREF V2629 0) 'shen.pvar))
                                      (LET ((A (shen.newpv V2862)))
                                       (do
                                        (shen.bindv V2629 (CONS A NIL) V2862)
                                        (LET
                                         ((Result
                                           (LET
                                            ((V2633
                                              (shen.lazyderef (CDR V2621)
                                               V2862)))
                                            (IF (NULL V2633)
                                             (LET ((Hyp (CDR V2612)))
                                              (do (shen.incinfs)
                                               (bind V2861
                                                (CONS
                                                 (CONS (shen.lazyderef X V2862)
                                                  (CONS '|:|
                                                   (CONS
                                                    (shen.lazyderef A V2862)
                                                    NIL)))
                                                 (CONS
                                                  (CONS
                                                   (shen.lazyderef Y V2862)
                                                   (CONS '|:|
                                                    (CONS
                                                     (CONS 'list
                                                      (CONS
                                                       (shen.lazyderef A V2862)
                                                       NIL))
                                                     NIL)))
                                                  (shen.lazyderef Hyp V2862)))
                                                V2862 V2863)))
                                             (IF
                                              (AND (ARRAYP V2633)
                                               (NOT (STRINGP V2633))
                                               (EQ (AREF V2633 0) 'shen.pvar))
                                              (do (shen.bindv V2633 NIL V2862)
                                               (LET
                                                ((Result
                                                  (LET ((Hyp (CDR V2612)))
                                                   (do (shen.incinfs)
                                                    (bind V2861
                                                     (CONS
                                                      (CONS
                                                       (shen.lazyderef X V2862)
                                                       (CONS '|:|
                                                        (CONS
                                                         (shen.lazyderef A
                                                          V2862)
                                                         NIL)))
                                                      (CONS
                                                       (CONS
                                                        (shen.lazyderef Y
                                                         V2862)
                                                        (CONS '|:|
                                                         (CONS
                                                          (CONS 'list
                                                           (CONS
                                                            (shen.lazyderef A
                                                             V2862)
                                                            NIL))
                                                          NIL)))
                                                       (shen.lazyderef Hyp
                                                        V2862)))
                                                     V2862 V2863)))))
                                                (do (shen.unbindv V2633 V2862)
                                                 Result)))
                                              'false)))))
                                         (do (shen.unbindv V2629 V2862)
                                          Result))))
                                      'false)))))
                                 (do (shen.unbindv V2623 V2862) Result)))
                               'false)))
                            (IF
                             (AND (ARRAYP V2622) (NOT (STRINGP V2622))
                              (EQ (AREF V2622 0) 'shen.pvar))
                             (LET ((A (shen.newpv V2862)))
                              (do
                               (shen.bindv V2622 (CONS 'list (CONS A NIL))
                                V2862)
                               (LET
                                ((Result
                                  (LET
                                   ((V2634 (shen.lazyderef (CDR V2621) V2862)))
                                   (IF (NULL V2634)
                                    (LET ((Hyp (CDR V2612)))
                                     (do (shen.incinfs)
                                      (bind V2861
                                       (CONS
                                        (CONS (shen.lazyderef X V2862)
                                         (CONS '|:|
                                          (CONS (shen.lazyderef A V2862) NIL)))
                                        (CONS
                                         (CONS (shen.lazyderef Y V2862)
                                          (CONS '|:|
                                           (CONS
                                            (CONS 'list
                                             (CONS (shen.lazyderef A V2862)
                                              NIL))
                                            NIL)))
                                         (shen.lazyderef Hyp V2862)))
                                       V2862 V2863)))
                                    (IF
                                     (AND (ARRAYP V2634) (NOT (STRINGP V2634))
                                      (EQ (AREF V2634 0) 'shen.pvar))
                                     (do (shen.bindv V2634 NIL V2862)
                                      (LET
                                       ((Result
                                         (LET ((Hyp (CDR V2612)))
                                          (do (shen.incinfs)
                                           (bind V2861
                                            (CONS
                                             (CONS (shen.lazyderef X V2862)
                                              (CONS '|:|
                                               (CONS (shen.lazyderef A V2862)
                                                NIL)))
                                             (CONS
                                              (CONS (shen.lazyderef Y V2862)
                                               (CONS '|:|
                                                (CONS
                                                 (CONS 'list
                                                  (CONS
                                                   (shen.lazyderef A V2862)
                                                   NIL))
                                                 NIL)))
                                              (shen.lazyderef Hyp V2862)))
                                            V2862 V2863)))))
                                       (do (shen.unbindv V2634 V2862) Result)))
                                     'false)))))
                                (do (shen.unbindv V2622 V2862) Result))))
                             'false)))
                          'false))
                        'false))
                      'false))
                    'false)))
                 'false)))
              'false))
            'false))
          'false))
        'false))
      'false))))
  (IF (shen.ABSEQUAL Case 'false)
   (LET
    ((Case
      (LET ((V2635 (shen.lazyderef V2860 V2862)))
       (IF (CONSP V2635)
        (LET ((V2636 (shen.lazyderef (CAR V2635) V2862)))
         (IF (CONSP V2636)
          (LET ((V2637 (shen.lazyderef (CAR V2636) V2862)))
           (IF (CONSP V2637)
            (LET ((V2638 (shen.lazyderef (CAR V2637) V2862)))
             (IF (EQ '@p V2638)
              (LET ((V2639 (shen.lazyderef (CDR V2637) V2862)))
               (IF (CONSP V2639)
                (LET ((X (CAR V2639)))
                 (LET ((V2640 (shen.lazyderef (CDR V2639) V2862)))
                  (IF (CONSP V2640)
                   (LET ((Y (CAR V2640)))
                    (LET ((V2641 (shen.lazyderef (CDR V2640) V2862)))
                     (IF (NULL V2641)
                      (LET ((V2642 (shen.lazyderef (CDR V2636) V2862)))
                       (IF (CONSP V2642)
                        (LET ((V2643 (shen.lazyderef (CAR V2642) V2862)))
                         (IF (EQ '|:| V2643)
                          (LET ((V2644 (shen.lazyderef (CDR V2642) V2862)))
                           (IF (CONSP V2644)
                            (LET ((V2645 (shen.lazyderef (CAR V2644) V2862)))
                             (IF (CONSP V2645)
                              (LET ((A (CAR V2645)))
                               (LET
                                ((V2646 (shen.lazyderef (CDR V2645) V2862)))
                                (IF (CONSP V2646)
                                 (LET
                                  ((V2647 (shen.lazyderef (CAR V2646) V2862)))
                                  (IF (EQ '* V2647)
                                   (LET
                                    ((V2648
                                      (shen.lazyderef (CDR V2646) V2862)))
                                    (IF (CONSP V2648)
                                     (LET ((B (CAR V2648)))
                                      (LET
                                       ((V2649
                                         (shen.lazyderef (CDR V2648) V2862)))
                                       (IF (NULL V2649)
                                        (LET
                                         ((V2650
                                           (shen.lazyderef (CDR V2644) V2862)))
                                         (IF (NULL V2650)
                                          (LET ((Hyp (CDR V2635)))
                                           (do (shen.incinfs)
                                            (bind V2861
                                             (CONS
                                              (CONS (shen.lazyderef X V2862)
                                               (CONS '|:|
                                                (CONS (shen.lazyderef A V2862)
                                                 NIL)))
                                              (CONS
                                               (CONS (shen.lazyderef Y V2862)
                                                (CONS '|:|
                                                 (CONS (shen.lazyderef B V2862)
                                                  NIL)))
                                               (shen.lazyderef Hyp V2862)))
                                             V2862 V2863)))
                                          (IF
                                           (AND (ARRAYP V2650)
                                            (NOT (STRINGP V2650))
                                            (EQ (AREF V2650 0) 'shen.pvar))
                                           (do (shen.bindv V2650 NIL V2862)
                                            (LET
                                             ((Result
                                               (LET ((Hyp (CDR V2635)))
                                                (do (shen.incinfs)
                                                 (bind V2861
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef X V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (shen.lazyderef A V2862)
                                                      NIL)))
                                                   (CONS
                                                    (CONS
                                                     (shen.lazyderef Y V2862)
                                                     (CONS '|:|
                                                      (CONS
                                                       (shen.lazyderef B V2862)
                                                       NIL)))
                                                    (shen.lazyderef Hyp
                                                     V2862)))
                                                  V2862 V2863)))))
                                             (do (shen.unbindv V2650 V2862)
                                              Result)))
                                           'false)))
                                        (IF
                                         (AND (ARRAYP V2649)
                                          (NOT (STRINGP V2649))
                                          (EQ (AREF V2649 0) 'shen.pvar))
                                         (do (shen.bindv V2649 NIL V2862)
                                          (LET
                                           ((Result
                                             (LET
                                              ((V2651
                                                (shen.lazyderef (CDR V2644)
                                                 V2862)))
                                              (IF (NULL V2651)
                                               (LET ((Hyp (CDR V2635)))
                                                (do (shen.incinfs)
                                                 (bind V2861
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef X V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (shen.lazyderef A V2862)
                                                      NIL)))
                                                   (CONS
                                                    (CONS
                                                     (shen.lazyderef Y V2862)
                                                     (CONS '|:|
                                                      (CONS
                                                       (shen.lazyderef B V2862)
                                                       NIL)))
                                                    (shen.lazyderef Hyp
                                                     V2862)))
                                                  V2862 V2863)))
                                               (IF
                                                (AND (ARRAYP V2651)
                                                 (NOT (STRINGP V2651))
                                                 (EQ (AREF V2651 0)
                                                  'shen.pvar))
                                                (do
                                                 (shen.bindv V2651 NIL V2862)
                                                 (LET
                                                  ((Result
                                                    (LET ((Hyp (CDR V2635)))
                                                     (do (shen.incinfs)
                                                      (bind V2861
                                                       (CONS
                                                        (CONS
                                                         (shen.lazyderef X
                                                          V2862)
                                                         (CONS '|:|
                                                          (CONS
                                                           (shen.lazyderef A
                                                            V2862)
                                                           NIL)))
                                                        (CONS
                                                         (CONS
                                                          (shen.lazyderef Y
                                                           V2862)
                                                          (CONS '|:|
                                                           (CONS
                                                            (shen.lazyderef B
                                                             V2862)
                                                            NIL)))
                                                         (shen.lazyderef Hyp
                                                          V2862)))
                                                       V2862 V2863)))))
                                                  (do
                                                   (shen.unbindv V2651 V2862)
                                                   Result)))
                                                'false)))))
                                           (do (shen.unbindv V2649 V2862)
                                            Result)))
                                         'false))))
                                     (IF
                                      (AND (ARRAYP V2648) (NOT (STRINGP V2648))
                                       (EQ (AREF V2648 0) 'shen.pvar))
                                      (LET ((B (shen.newpv V2862)))
                                       (do
                                        (shen.bindv V2648 (CONS B NIL) V2862)
                                        (LET
                                         ((Result
                                           (LET
                                            ((V2652
                                              (shen.lazyderef (CDR V2644)
                                               V2862)))
                                            (IF (NULL V2652)
                                             (LET ((Hyp (CDR V2635)))
                                              (do (shen.incinfs)
                                               (bind V2861
                                                (CONS
                                                 (CONS (shen.lazyderef X V2862)
                                                  (CONS '|:|
                                                   (CONS
                                                    (shen.lazyderef A V2862)
                                                    NIL)))
                                                 (CONS
                                                  (CONS
                                                   (shen.lazyderef Y V2862)
                                                   (CONS '|:|
                                                    (CONS
                                                     (shen.lazyderef B V2862)
                                                     NIL)))
                                                  (shen.lazyderef Hyp V2862)))
                                                V2862 V2863)))
                                             (IF
                                              (AND (ARRAYP V2652)
                                               (NOT (STRINGP V2652))
                                               (EQ (AREF V2652 0) 'shen.pvar))
                                              (do (shen.bindv V2652 NIL V2862)
                                               (LET
                                                ((Result
                                                  (LET ((Hyp (CDR V2635)))
                                                   (do (shen.incinfs)
                                                    (bind V2861
                                                     (CONS
                                                      (CONS
                                                       (shen.lazyderef X V2862)
                                                       (CONS '|:|
                                                        (CONS
                                                         (shen.lazyderef A
                                                          V2862)
                                                         NIL)))
                                                      (CONS
                                                       (CONS
                                                        (shen.lazyderef Y
                                                         V2862)
                                                        (CONS '|:|
                                                         (CONS
                                                          (shen.lazyderef B
                                                           V2862)
                                                          NIL)))
                                                       (shen.lazyderef Hyp
                                                        V2862)))
                                                     V2862 V2863)))))
                                                (do (shen.unbindv V2652 V2862)
                                                 Result)))
                                              'false)))))
                                         (do (shen.unbindv V2648 V2862)
                                          Result))))
                                      'false)))
                                   (IF
                                    (AND (ARRAYP V2647) (NOT (STRINGP V2647))
                                     (EQ (AREF V2647 0) 'shen.pvar))
                                    (do (shen.bindv V2647 '* V2862)
                                     (LET
                                      ((Result
                                        (LET
                                         ((V2653
                                           (shen.lazyderef (CDR V2646) V2862)))
                                         (IF (CONSP V2653)
                                          (LET ((B (CAR V2653)))
                                           (LET
                                            ((V2654
                                              (shen.lazyderef (CDR V2653)
                                               V2862)))
                                            (IF (NULL V2654)
                                             (LET
                                              ((V2655
                                                (shen.lazyderef (CDR V2644)
                                                 V2862)))
                                              (IF (NULL V2655)
                                               (LET ((Hyp (CDR V2635)))
                                                (do (shen.incinfs)
                                                 (bind V2861
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef X V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (shen.lazyderef A V2862)
                                                      NIL)))
                                                   (CONS
                                                    (CONS
                                                     (shen.lazyderef Y V2862)
                                                     (CONS '|:|
                                                      (CONS
                                                       (shen.lazyderef B V2862)
                                                       NIL)))
                                                    (shen.lazyderef Hyp
                                                     V2862)))
                                                  V2862 V2863)))
                                               (IF
                                                (AND (ARRAYP V2655)
                                                 (NOT (STRINGP V2655))
                                                 (EQ (AREF V2655 0)
                                                  'shen.pvar))
                                                (do
                                                 (shen.bindv V2655 NIL V2862)
                                                 (LET
                                                  ((Result
                                                    (LET ((Hyp (CDR V2635)))
                                                     (do (shen.incinfs)
                                                      (bind V2861
                                                       (CONS
                                                        (CONS
                                                         (shen.lazyderef X
                                                          V2862)
                                                         (CONS '|:|
                                                          (CONS
                                                           (shen.lazyderef A
                                                            V2862)
                                                           NIL)))
                                                        (CONS
                                                         (CONS
                                                          (shen.lazyderef Y
                                                           V2862)
                                                          (CONS '|:|
                                                           (CONS
                                                            (shen.lazyderef B
                                                             V2862)
                                                            NIL)))
                                                         (shen.lazyderef Hyp
                                                          V2862)))
                                                       V2862 V2863)))))
                                                  (do
                                                   (shen.unbindv V2655 V2862)
                                                   Result)))
                                                'false)))
                                             (IF
                                              (AND (ARRAYP V2654)
                                               (NOT (STRINGP V2654))
                                               (EQ (AREF V2654 0) 'shen.pvar))
                                              (do (shen.bindv V2654 NIL V2862)
                                               (LET
                                                ((Result
                                                  (LET
                                                   ((V2656
                                                     (shen.lazyderef
                                                      (CDR V2644) V2862)))
                                                   (IF (NULL V2656)
                                                    (LET ((Hyp (CDR V2635)))
                                                     (do (shen.incinfs)
                                                      (bind V2861
                                                       (CONS
                                                        (CONS
                                                         (shen.lazyderef X
                                                          V2862)
                                                         (CONS '|:|
                                                          (CONS
                                                           (shen.lazyderef A
                                                            V2862)
                                                           NIL)))
                                                        (CONS
                                                         (CONS
                                                          (shen.lazyderef Y
                                                           V2862)
                                                          (CONS '|:|
                                                           (CONS
                                                            (shen.lazyderef B
                                                             V2862)
                                                            NIL)))
                                                         (shen.lazyderef Hyp
                                                          V2862)))
                                                       V2862 V2863)))
                                                    (IF
                                                     (AND (ARRAYP V2656)
                                                      (NOT (STRINGP V2656))
                                                      (EQ (AREF V2656 0)
                                                       'shen.pvar))
                                                     (do
                                                      (shen.bindv V2656 NIL
                                                       V2862)
                                                      (LET
                                                       ((Result
                                                         (LET
                                                          ((Hyp (CDR V2635)))
                                                          (do (shen.incinfs)
                                                           (bind V2861
                                                            (CONS
                                                             (CONS
                                                              (shen.lazyderef X
                                                               V2862)
                                                              (CONS '|:|
                                                               (CONS
                                                                (shen.lazyderef
                                                                 A V2862)
                                                                NIL)))
                                                             (CONS
                                                              (CONS
                                                               (shen.lazyderef
                                                                Y V2862)
                                                               (CONS '|:|
                                                                (CONS
                                                                 (shen.lazyderef
                                                                  B V2862)
                                                                 NIL)))
                                                              (shen.lazyderef
                                                               Hyp V2862)))
                                                            V2862 V2863)))))
                                                       (do
                                                        (shen.unbindv V2656
                                                         V2862)
                                                        Result)))
                                                     'false)))))
                                                (do (shen.unbindv V2654 V2862)
                                                 Result)))
                                              'false))))
                                          (IF
                                           (AND (ARRAYP V2653)
                                            (NOT (STRINGP V2653))
                                            (EQ (AREF V2653 0) 'shen.pvar))
                                           (LET ((B (shen.newpv V2862)))
                                            (do
                                             (shen.bindv V2653 (CONS B NIL)
                                              V2862)
                                             (LET
                                              ((Result
                                                (LET
                                                 ((V2657
                                                   (shen.lazyderef (CDR V2644)
                                                    V2862)))
                                                 (IF (NULL V2657)
                                                  (LET ((Hyp (CDR V2635)))
                                                   (do (shen.incinfs)
                                                    (bind V2861
                                                     (CONS
                                                      (CONS
                                                       (shen.lazyderef X V2862)
                                                       (CONS '|:|
                                                        (CONS
                                                         (shen.lazyderef A
                                                          V2862)
                                                         NIL)))
                                                      (CONS
                                                       (CONS
                                                        (shen.lazyderef Y
                                                         V2862)
                                                        (CONS '|:|
                                                         (CONS
                                                          (shen.lazyderef B
                                                           V2862)
                                                          NIL)))
                                                       (shen.lazyderef Hyp
                                                        V2862)))
                                                     V2862 V2863)))
                                                  (IF
                                                   (AND (ARRAYP V2657)
                                                    (NOT (STRINGP V2657))
                                                    (EQ (AREF V2657 0)
                                                     'shen.pvar))
                                                   (do
                                                    (shen.bindv V2657 NIL
                                                     V2862)
                                                    (LET
                                                     ((Result
                                                       (LET ((Hyp (CDR V2635)))
                                                        (do (shen.incinfs)
                                                         (bind V2861
                                                          (CONS
                                                           (CONS
                                                            (shen.lazyderef X
                                                             V2862)
                                                            (CONS '|:|
                                                             (CONS
                                                              (shen.lazyderef A
                                                               V2862)
                                                              NIL)))
                                                           (CONS
                                                            (CONS
                                                             (shen.lazyderef Y
                                                              V2862)
                                                             (CONS '|:|
                                                              (CONS
                                                               (shen.lazyderef
                                                                B V2862)
                                                               NIL)))
                                                            (shen.lazyderef Hyp
                                                             V2862)))
                                                          V2862 V2863)))))
                                                     (do
                                                      (shen.unbindv V2657
                                                       V2862)
                                                      Result)))
                                                   'false)))))
                                              (do (shen.unbindv V2653 V2862)
                                               Result))))
                                           'false)))))
                                      (do (shen.unbindv V2647 V2862) Result)))
                                    'false)))
                                 (IF
                                  (AND (ARRAYP V2646) (NOT (STRINGP V2646))
                                   (EQ (AREF V2646 0) 'shen.pvar))
                                  (LET ((B (shen.newpv V2862)))
                                   (do
                                    (shen.bindv V2646 (CONS '* (CONS B NIL))
                                     V2862)
                                    (LET
                                     ((Result
                                       (LET
                                        ((V2658
                                          (shen.lazyderef (CDR V2644) V2862)))
                                        (IF (NULL V2658)
                                         (LET ((Hyp (CDR V2635)))
                                          (do (shen.incinfs)
                                           (bind V2861
                                            (CONS
                                             (CONS (shen.lazyderef X V2862)
                                              (CONS '|:|
                                               (CONS (shen.lazyderef A V2862)
                                                NIL)))
                                             (CONS
                                              (CONS (shen.lazyderef Y V2862)
                                               (CONS '|:|
                                                (CONS (shen.lazyderef B V2862)
                                                 NIL)))
                                              (shen.lazyderef Hyp V2862)))
                                            V2862 V2863)))
                                         (IF
                                          (AND (ARRAYP V2658)
                                           (NOT (STRINGP V2658))
                                           (EQ (AREF V2658 0) 'shen.pvar))
                                          (do (shen.bindv V2658 NIL V2862)
                                           (LET
                                            ((Result
                                              (LET ((Hyp (CDR V2635)))
                                               (do (shen.incinfs)
                                                (bind V2861
                                                 (CONS
                                                  (CONS
                                                   (shen.lazyderef X V2862)
                                                   (CONS '|:|
                                                    (CONS
                                                     (shen.lazyderef A V2862)
                                                     NIL)))
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef Y V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (shen.lazyderef B V2862)
                                                      NIL)))
                                                   (shen.lazyderef Hyp V2862)))
                                                 V2862 V2863)))))
                                            (do (shen.unbindv V2658 V2862)
                                             Result)))
                                          'false)))))
                                     (do (shen.unbindv V2646 V2862) Result))))
                                  'false))))
                              (IF
                               (AND (ARRAYP V2645) (NOT (STRINGP V2645))
                                (EQ (AREF V2645 0) 'shen.pvar))
                               (LET ((A (shen.newpv V2862)))
                                (LET ((B (shen.newpv V2862)))
                                 (do
                                  (shen.bindv V2645
                                   (CONS A (CONS '* (CONS B NIL))) V2862)
                                  (LET
                                   ((Result
                                     (LET
                                      ((V2659
                                        (shen.lazyderef (CDR V2644) V2862)))
                                      (IF (NULL V2659)
                                       (LET ((Hyp (CDR V2635)))
                                        (do (shen.incinfs)
                                         (bind V2861
                                          (CONS
                                           (CONS (shen.lazyderef X V2862)
                                            (CONS '|:|
                                             (CONS (shen.lazyderef A V2862)
                                              NIL)))
                                           (CONS
                                            (CONS (shen.lazyderef Y V2862)
                                             (CONS '|:|
                                              (CONS (shen.lazyderef B V2862)
                                               NIL)))
                                            (shen.lazyderef Hyp V2862)))
                                          V2862 V2863)))
                                       (IF
                                        (AND (ARRAYP V2659)
                                         (NOT (STRINGP V2659))
                                         (EQ (AREF V2659 0) 'shen.pvar))
                                        (do (shen.bindv V2659 NIL V2862)
                                         (LET
                                          ((Result
                                            (LET ((Hyp (CDR V2635)))
                                             (do (shen.incinfs)
                                              (bind V2861
                                               (CONS
                                                (CONS (shen.lazyderef X V2862)
                                                 (CONS '|:|
                                                  (CONS
                                                   (shen.lazyderef A V2862)
                                                   NIL)))
                                                (CONS
                                                 (CONS (shen.lazyderef Y V2862)
                                                  (CONS '|:|
                                                   (CONS
                                                    (shen.lazyderef B V2862)
                                                    NIL)))
                                                 (shen.lazyderef Hyp V2862)))
                                               V2862 V2863)))))
                                          (do (shen.unbindv V2659 V2862)
                                           Result)))
                                        'false)))))
                                   (do (shen.unbindv V2645 V2862) Result)))))
                               'false)))
                            'false))
                          'false))
                        'false))
                      'false)))
                   'false)))
                'false))
              'false))
            'false))
          'false))
        'false))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET
      ((Case
        (LET ((V2660 (shen.lazyderef V2860 V2862)))
         (IF (CONSP V2660)
          (LET ((V2661 (shen.lazyderef (CAR V2660) V2862)))
           (IF (CONSP V2661)
            (LET ((V2662 (shen.lazyderef (CAR V2661) V2862)))
             (IF (CONSP V2662)
              (LET ((V2663 (shen.lazyderef (CAR V2662) V2862)))
               (IF (EQ '@v V2663)
                (LET ((V2664 (shen.lazyderef (CDR V2662) V2862)))
                 (IF (CONSP V2664)
                  (LET ((X (CAR V2664)))
                   (LET ((V2665 (shen.lazyderef (CDR V2664) V2862)))
                    (IF (CONSP V2665)
                     (LET ((Y (CAR V2665)))
                      (LET ((V2666 (shen.lazyderef (CDR V2665) V2862)))
                       (IF (NULL V2666)
                        (LET ((V2667 (shen.lazyderef (CDR V2661) V2862)))
                         (IF (CONSP V2667)
                          (LET ((V2668 (shen.lazyderef (CAR V2667) V2862)))
                           (IF (EQ '|:| V2668)
                            (LET ((V2669 (shen.lazyderef (CDR V2667) V2862)))
                             (IF (CONSP V2669)
                              (LET ((V2670 (shen.lazyderef (CAR V2669) V2862)))
                               (IF (CONSP V2670)
                                (LET
                                 ((V2671 (shen.lazyderef (CAR V2670) V2862)))
                                 (IF (EQ 'vector V2671)
                                  (LET
                                   ((V2672 (shen.lazyderef (CDR V2670) V2862)))
                                   (IF (CONSP V2672)
                                    (LET ((A (CAR V2672)))
                                     (LET
                                      ((V2673
                                        (shen.lazyderef (CDR V2672) V2862)))
                                      (IF (NULL V2673)
                                       (LET
                                        ((V2674
                                          (shen.lazyderef (CDR V2669) V2862)))
                                        (IF (NULL V2674)
                                         (LET ((Hyp (CDR V2660)))
                                          (do (shen.incinfs)
                                           (bind V2861
                                            (CONS
                                             (CONS (shen.lazyderef X V2862)
                                              (CONS '|:|
                                               (CONS (shen.lazyderef A V2862)
                                                NIL)))
                                             (CONS
                                              (CONS (shen.lazyderef Y V2862)
                                               (CONS '|:|
                                                (CONS
                                                 (CONS 'vector
                                                  (CONS
                                                   (shen.lazyderef A V2862)
                                                   NIL))
                                                 NIL)))
                                              (shen.lazyderef Hyp V2862)))
                                            V2862 V2863)))
                                         (IF
                                          (AND (ARRAYP V2674)
                                           (NOT (STRINGP V2674))
                                           (EQ (AREF V2674 0) 'shen.pvar))
                                          (do (shen.bindv V2674 NIL V2862)
                                           (LET
                                            ((Result
                                              (LET ((Hyp (CDR V2660)))
                                               (do (shen.incinfs)
                                                (bind V2861
                                                 (CONS
                                                  (CONS
                                                   (shen.lazyderef X V2862)
                                                   (CONS '|:|
                                                    (CONS
                                                     (shen.lazyderef A V2862)
                                                     NIL)))
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef Y V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (CONS 'vector
                                                       (CONS
                                                        (shen.lazyderef A
                                                         V2862)
                                                        NIL))
                                                      NIL)))
                                                   (shen.lazyderef Hyp V2862)))
                                                 V2862 V2863)))))
                                            (do (shen.unbindv V2674 V2862)
                                             Result)))
                                          'false)))
                                       (IF
                                        (AND (ARRAYP V2673)
                                         (NOT (STRINGP V2673))
                                         (EQ (AREF V2673 0) 'shen.pvar))
                                        (do (shen.bindv V2673 NIL V2862)
                                         (LET
                                          ((Result
                                            (LET
                                             ((V2675
                                               (shen.lazyderef (CDR V2669)
                                                V2862)))
                                             (IF (NULL V2675)
                                              (LET ((Hyp (CDR V2660)))
                                               (do (shen.incinfs)
                                                (bind V2861
                                                 (CONS
                                                  (CONS
                                                   (shen.lazyderef X V2862)
                                                   (CONS '|:|
                                                    (CONS
                                                     (shen.lazyderef A V2862)
                                                     NIL)))
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef Y V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (CONS 'vector
                                                       (CONS
                                                        (shen.lazyderef A
                                                         V2862)
                                                        NIL))
                                                      NIL)))
                                                   (shen.lazyderef Hyp V2862)))
                                                 V2862 V2863)))
                                              (IF
                                               (AND (ARRAYP V2675)
                                                (NOT (STRINGP V2675))
                                                (EQ (AREF V2675 0) 'shen.pvar))
                                               (do (shen.bindv V2675 NIL V2862)
                                                (LET
                                                 ((Result
                                                   (LET ((Hyp (CDR V2660)))
                                                    (do (shen.incinfs)
                                                     (bind V2861
                                                      (CONS
                                                       (CONS
                                                        (shen.lazyderef X
                                                         V2862)
                                                        (CONS '|:|
                                                         (CONS
                                                          (shen.lazyderef A
                                                           V2862)
                                                          NIL)))
                                                       (CONS
                                                        (CONS
                                                         (shen.lazyderef Y
                                                          V2862)
                                                         (CONS '|:|
                                                          (CONS
                                                           (CONS 'vector
                                                            (CONS
                                                             (shen.lazyderef A
                                                              V2862)
                                                             NIL))
                                                           NIL)))
                                                        (shen.lazyderef Hyp
                                                         V2862)))
                                                      V2862 V2863)))))
                                                 (do (shen.unbindv V2675 V2862)
                                                  Result)))
                                               'false)))))
                                          (do (shen.unbindv V2673 V2862)
                                           Result)))
                                        'false))))
                                    (IF
                                     (AND (ARRAYP V2672) (NOT (STRINGP V2672))
                                      (EQ (AREF V2672 0) 'shen.pvar))
                                     (LET ((A (shen.newpv V2862)))
                                      (do (shen.bindv V2672 (CONS A NIL) V2862)
                                       (LET
                                        ((Result
                                          (LET
                                           ((V2676
                                             (shen.lazyderef (CDR V2669)
                                              V2862)))
                                           (IF (NULL V2676)
                                            (LET ((Hyp (CDR V2660)))
                                             (do (shen.incinfs)
                                              (bind V2861
                                               (CONS
                                                (CONS (shen.lazyderef X V2862)
                                                 (CONS '|:|
                                                  (CONS
                                                   (shen.lazyderef A V2862)
                                                   NIL)))
                                                (CONS
                                                 (CONS (shen.lazyderef Y V2862)
                                                  (CONS '|:|
                                                   (CONS
                                                    (CONS 'vector
                                                     (CONS
                                                      (shen.lazyderef A V2862)
                                                      NIL))
                                                    NIL)))
                                                 (shen.lazyderef Hyp V2862)))
                                               V2862 V2863)))
                                            (IF
                                             (AND (ARRAYP V2676)
                                              (NOT (STRINGP V2676))
                                              (EQ (AREF V2676 0) 'shen.pvar))
                                             (do (shen.bindv V2676 NIL V2862)
                                              (LET
                                               ((Result
                                                 (LET ((Hyp (CDR V2660)))
                                                  (do (shen.incinfs)
                                                   (bind V2861
                                                    (CONS
                                                     (CONS
                                                      (shen.lazyderef X V2862)
                                                      (CONS '|:|
                                                       (CONS
                                                        (shen.lazyderef A
                                                         V2862)
                                                        NIL)))
                                                     (CONS
                                                      (CONS
                                                       (shen.lazyderef Y V2862)
                                                       (CONS '|:|
                                                        (CONS
                                                         (CONS 'vector
                                                          (CONS
                                                           (shen.lazyderef A
                                                            V2862)
                                                           NIL))
                                                         NIL)))
                                                      (shen.lazyderef Hyp
                                                       V2862)))
                                                    V2862 V2863)))))
                                               (do (shen.unbindv V2676 V2862)
                                                Result)))
                                             'false)))))
                                        (do (shen.unbindv V2672 V2862)
                                         Result))))
                                     'false)))
                                  (IF
                                   (AND (ARRAYP V2671) (NOT (STRINGP V2671))
                                    (EQ (AREF V2671 0) 'shen.pvar))
                                   (do (shen.bindv V2671 'vector V2862)
                                    (LET
                                     ((Result
                                       (LET
                                        ((V2677
                                          (shen.lazyderef (CDR V2670) V2862)))
                                        (IF (CONSP V2677)
                                         (LET ((A (CAR V2677)))
                                          (LET
                                           ((V2678
                                             (shen.lazyderef (CDR V2677)
                                              V2862)))
                                           (IF (NULL V2678)
                                            (LET
                                             ((V2679
                                               (shen.lazyderef (CDR V2669)
                                                V2862)))
                                             (IF (NULL V2679)
                                              (LET ((Hyp (CDR V2660)))
                                               (do (shen.incinfs)
                                                (bind V2861
                                                 (CONS
                                                  (CONS
                                                   (shen.lazyderef X V2862)
                                                   (CONS '|:|
                                                    (CONS
                                                     (shen.lazyderef A V2862)
                                                     NIL)))
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef Y V2862)
                                                    (CONS '|:|
                                                     (CONS
                                                      (CONS 'vector
                                                       (CONS
                                                        (shen.lazyderef A
                                                         V2862)
                                                        NIL))
                                                      NIL)))
                                                   (shen.lazyderef Hyp V2862)))
                                                 V2862 V2863)))
                                              (IF
                                               (AND (ARRAYP V2679)
                                                (NOT (STRINGP V2679))
                                                (EQ (AREF V2679 0) 'shen.pvar))
                                               (do (shen.bindv V2679 NIL V2862)
                                                (LET
                                                 ((Result
                                                   (LET ((Hyp (CDR V2660)))
                                                    (do (shen.incinfs)
                                                     (bind V2861
                                                      (CONS
                                                       (CONS
                                                        (shen.lazyderef X
                                                         V2862)
                                                        (CONS '|:|
                                                         (CONS
                                                          (shen.lazyderef A
                                                           V2862)
                                                          NIL)))
                                                       (CONS
                                                        (CONS
                                                         (shen.lazyderef Y
                                                          V2862)
                                                         (CONS '|:|
                                                          (CONS
                                                           (CONS 'vector
                                                            (CONS
                                                             (shen.lazyderef A
                                                              V2862)
                                                             NIL))
                                                           NIL)))
                                                        (shen.lazyderef Hyp
                                                         V2862)))
                                                      V2862 V2863)))))
                                                 (do (shen.unbindv V2679 V2862)
                                                  Result)))
                                               'false)))
                                            (IF
                                             (AND (ARRAYP V2678)
                                              (NOT (STRINGP V2678))
                                              (EQ (AREF V2678 0) 'shen.pvar))
                                             (do (shen.bindv V2678 NIL V2862)
                                              (LET
                                               ((Result
                                                 (LET
                                                  ((V2680
                                                    (shen.lazyderef (CDR V2669)
                                                     V2862)))
                                                  (IF (NULL V2680)
                                                   (LET ((Hyp (CDR V2660)))
                                                    (do (shen.incinfs)
                                                     (bind V2861
                                                      (CONS
                                                       (CONS
                                                        (shen.lazyderef X
                                                         V2862)
                                                        (CONS '|:|
                                                         (CONS
                                                          (shen.lazyderef A
                                                           V2862)
                                                          NIL)))
                                                       (CONS
                                                        (CONS
                                                         (shen.lazyderef Y
                                                          V2862)
                                                         (CONS '|:|
                                                          (CONS
                                                           (CONS 'vector
                                                            (CONS
                                                             (shen.lazyderef A
                                                              V2862)
                                                             NIL))
                                                           NIL)))
                                                        (shen.lazyderef Hyp
                                                         V2862)))
                                                      V2862 V2863)))
                                                   (IF
                                                    (AND (ARRAYP V2680)
                                                     (NOT (STRINGP V2680))
                                                     (EQ (AREF V2680 0)
                                                      'shen.pvar))
                                                    (do
                                                     (shen.bindv V2680 NIL
                                                      V2862)
                                                     (LET
                                                      ((Result
                                                        (LET
                                                         ((Hyp (CDR V2660)))
                                                         (do (shen.incinfs)
                                                          (bind V2861
                                                           (CONS
                                                            (CONS
                                                             (shen.lazyderef X
                                                              V2862)
                                                             (CONS '|:|
                                                              (CONS
                                                               (shen.lazyderef
                                                                A V2862)
                                                               NIL)))
                                                            (CONS
                                                             (CONS
                                                              (shen.lazyderef Y
                                                               V2862)
                                                              (CONS '|:|
                                                               (CONS
                                                                (CONS 'vector
                                                                 (CONS
                                                                  (shen.lazyderef
                                                                   A V2862)
                                                                  NIL))
                                                                NIL)))
                                                             (shen.lazyderef
                                                              Hyp V2862)))
                                                           V2862 V2863)))))
                                                      (do
                                                       (shen.unbindv V2680
                                                        V2862)
                                                       Result)))
                                                    'false)))))
                                               (do (shen.unbindv V2678 V2862)
                                                Result)))
                                             'false))))
                                         (IF
                                          (AND (ARRAYP V2677)
                                           (NOT (STRINGP V2677))
                                           (EQ (AREF V2677 0) 'shen.pvar))
                                          (LET ((A (shen.newpv V2862)))
                                           (do
                                            (shen.bindv V2677 (CONS A NIL)
                                             V2862)
                                            (LET
                                             ((Result
                                               (LET
                                                ((V2681
                                                  (shen.lazyderef (CDR V2669)
                                                   V2862)))
                                                (IF (NULL V2681)
                                                 (LET ((Hyp (CDR V2660)))
                                                  (do (shen.incinfs)
                                                   (bind V2861
                                                    (CONS
                                                     (CONS
                                                      (shen.lazyderef X V2862)
                                                      (CONS '|:|
                                                       (CONS
                                                        (shen.lazyderef A
                                                         V2862)
                                                        NIL)))
                                                     (CONS
                                                      (CONS
                                                       (shen.lazyderef Y V2862)
                                                       (CONS '|:|
                                                        (CONS
                                                         (CONS 'vector
                                                          (CONS
                                                           (shen.lazyderef A
                                                            V2862)
                                                           NIL))
                                                         NIL)))
                                                      (shen.lazyderef Hyp
                                                       V2862)))
                                                    V2862 V2863)))
                                                 (IF
                                                  (AND (ARRAYP V2681)
                                                   (NOT (STRINGP V2681))
                                                   (EQ (AREF V2681 0)
                                                    'shen.pvar))
                                                  (do
                                                   (shen.bindv V2681 NIL V2862)
                                                   (LET
                                                    ((Result
                                                      (LET ((Hyp (CDR V2660)))
                                                       (do (shen.incinfs)
                                                        (bind V2861
                                                         (CONS
                                                          (CONS
                                                           (shen.lazyderef X
                                                            V2862)
                                                           (CONS '|:|
                                                            (CONS
                                                             (shen.lazyderef A
                                                              V2862)
                                                             NIL)))
                                                          (CONS
                                                           (CONS
                                                            (shen.lazyderef Y
                                                             V2862)
                                                            (CONS '|:|
                                                             (CONS
                                                              (CONS 'vector
                                                               (CONS
                                                                (shen.lazyderef
                                                                 A V2862)
                                                                NIL))
                                                              NIL)))
                                                           (shen.lazyderef Hyp
                                                            V2862)))
                                                         V2862 V2863)))))
                                                    (do
                                                     (shen.unbindv V2681 V2862)
                                                     Result)))
                                                  'false)))))
                                             (do (shen.unbindv V2677 V2862)
                                              Result))))
                                          'false)))))
                                     (do (shen.unbindv V2671 V2862) Result)))
                                   'false)))
                                (IF
                                 (AND (ARRAYP V2670) (NOT (STRINGP V2670))
                                  (EQ (AREF V2670 0) 'shen.pvar))
                                 (LET ((A (shen.newpv V2862)))
                                  (do
                                   (shen.bindv V2670
                                    (CONS 'vector (CONS A NIL)) V2862)
                                   (LET
                                    ((Result
                                      (LET
                                       ((V2682
                                         (shen.lazyderef (CDR V2669) V2862)))
                                       (IF (NULL V2682)
                                        (LET ((Hyp (CDR V2660)))
                                         (do (shen.incinfs)
                                          (bind V2861
                                           (CONS
                                            (CONS (shen.lazyderef X V2862)
                                             (CONS '|:|
                                              (CONS (shen.lazyderef A V2862)
                                               NIL)))
                                            (CONS
                                             (CONS (shen.lazyderef Y V2862)
                                              (CONS '|:|
                                               (CONS
                                                (CONS 'vector
                                                 (CONS (shen.lazyderef A V2862)
                                                  NIL))
                                                NIL)))
                                             (shen.lazyderef Hyp V2862)))
                                           V2862 V2863)))
                                        (IF
                                         (AND (ARRAYP V2682)
                                          (NOT (STRINGP V2682))
                                          (EQ (AREF V2682 0) 'shen.pvar))
                                         (do (shen.bindv V2682 NIL V2862)
                                          (LET
                                           ((Result
                                             (LET ((Hyp (CDR V2660)))
                                              (do (shen.incinfs)
                                               (bind V2861
                                                (CONS
                                                 (CONS (shen.lazyderef X V2862)
                                                  (CONS '|:|
                                                   (CONS
                                                    (shen.lazyderef A V2862)
                                                    NIL)))
                                                 (CONS
                                                  (CONS
                                                   (shen.lazyderef Y V2862)
                                                   (CONS '|:|
                                                    (CONS
                                                     (CONS 'vector
                                                      (CONS
                                                       (shen.lazyderef A V2862)
                                                       NIL))
                                                     NIL)))
                                                  (shen.lazyderef Hyp V2862)))
                                                V2862 V2863)))))
                                           (do (shen.unbindv V2682 V2862)
                                            Result)))
                                         'false)))))
                                    (do (shen.unbindv V2670 V2862) Result))))
                                 'false)))
                              'false))
                            'false))
                          'false))
                        'false)))
                     'false)))
                  'false))
                'false))
              'false))
            'false))
          'false))))
      (IF (shen.ABSEQUAL Case 'false)
       (LET
        ((Case
          (LET ((V2683 (shen.lazyderef V2860 V2862)))
           (IF (CONSP V2683)
            (LET ((V2684 (shen.lazyderef (CAR V2683) V2862)))
             (IF (CONSP V2684)
              (LET ((V2685 (shen.lazyderef (CAR V2684) V2862)))
               (IF (CONSP V2685)
                (LET ((V2686 (shen.lazyderef (CAR V2685) V2862)))
                 (IF (EQ '@s V2686)
                  (LET ((V2687 (shen.lazyderef (CDR V2685) V2862)))
                   (IF (CONSP V2687)
                    (LET ((X (CAR V2687)))
                     (LET ((V2688 (shen.lazyderef (CDR V2687) V2862)))
                      (IF (CONSP V2688)
                       (LET ((Y (CAR V2688)))
                        (LET ((V2689 (shen.lazyderef (CDR V2688) V2862)))
                         (IF (NULL V2689)
                          (LET ((V2690 (shen.lazyderef (CDR V2684) V2862)))
                           (IF (CONSP V2690)
                            (LET ((V2691 (shen.lazyderef (CAR V2690) V2862)))
                             (IF (EQ '|:| V2691)
                              (LET ((V2692 (shen.lazyderef (CDR V2690) V2862)))
                               (IF (CONSP V2692)
                                (LET
                                 ((V2693 (shen.lazyderef (CAR V2692) V2862)))
                                 (IF (EQ 'string V2693)
                                  (LET
                                   ((V2694 (shen.lazyderef (CDR V2692) V2862)))
                                   (IF (NULL V2694)
                                    (LET ((Hyp (CDR V2683)))
                                     (do (shen.incinfs)
                                      (bind V2861
                                       (CONS
                                        (CONS (shen.lazyderef X V2862)
                                         (CONS '|:| (CONS 'string NIL)))
                                        (CONS
                                         (CONS (shen.lazyderef Y V2862)
                                          (CONS '|:| (CONS 'string NIL)))
                                         (shen.lazyderef Hyp V2862)))
                                       V2862 V2863)))
                                    (IF
                                     (AND (ARRAYP V2694) (NOT (STRINGP V2694))
                                      (EQ (AREF V2694 0) 'shen.pvar))
                                     (do (shen.bindv V2694 NIL V2862)
                                      (LET
                                       ((Result
                                         (LET ((Hyp (CDR V2683)))
                                          (do (shen.incinfs)
                                           (bind V2861
                                            (CONS
                                             (CONS (shen.lazyderef X V2862)
                                              (CONS '|:| (CONS 'string NIL)))
                                             (CONS
                                              (CONS (shen.lazyderef Y V2862)
                                               (CONS '|:| (CONS 'string NIL)))
                                              (shen.lazyderef Hyp V2862)))
                                            V2862 V2863)))))
                                       (do (shen.unbindv V2694 V2862) Result)))
                                     'false)))
                                  (IF
                                   (AND (ARRAYP V2693) (NOT (STRINGP V2693))
                                    (EQ (AREF V2693 0) 'shen.pvar))
                                   (do (shen.bindv V2693 'string V2862)
                                    (LET
                                     ((Result
                                       (LET
                                        ((V2695
                                          (shen.lazyderef (CDR V2692) V2862)))
                                        (IF (NULL V2695)
                                         (LET ((Hyp (CDR V2683)))
                                          (do (shen.incinfs)
                                           (bind V2861
                                            (CONS
                                             (CONS (shen.lazyderef X V2862)
                                              (CONS '|:| (CONS 'string NIL)))
                                             (CONS
                                              (CONS (shen.lazyderef Y V2862)
                                               (CONS '|:| (CONS 'string NIL)))
                                              (shen.lazyderef Hyp V2862)))
                                            V2862 V2863)))
                                         (IF
                                          (AND (ARRAYP V2695)
                                           (NOT (STRINGP V2695))
                                           (EQ (AREF V2695 0) 'shen.pvar))
                                          (do (shen.bindv V2695 NIL V2862)
                                           (LET
                                            ((Result
                                              (LET ((Hyp (CDR V2683)))
                                               (do (shen.incinfs)
                                                (bind V2861
                                                 (CONS
                                                  (CONS
                                                   (shen.lazyderef X V2862)
                                                   (CONS '|:|
                                                    (CONS 'string NIL)))
                                                  (CONS
                                                   (CONS
                                                    (shen.lazyderef Y V2862)
                                                    (CONS '|:|
                                                     (CONS 'string NIL)))
                                                   (shen.lazyderef Hyp V2862)))
                                                 V2862 V2863)))))
                                            (do (shen.unbindv V2695 V2862)
                                             Result)))
                                          'false)))))
                                     (do (shen.unbindv V2693 V2862) Result)))
                                   'false)))
                                'false))
                              'false))
                            'false))
                          'false)))
                       'false)))
                    'false))
                  'false))
                'false))
              'false))
            'false))))
        (IF (shen.ABSEQUAL Case 'false)
         (LET ((V2696 (shen.lazyderef V2860 V2862)))
          (IF (CONSP V2696)
           (LET ((X (CAR V2696)))
            (LET ((Hyp (CDR V2696)))
             (LET ((NewHyps (shen.newpv V2862)))
              (do (shen.incinfs)
               (bind V2861
                (CONS (shen.lazyderef X V2862) (shen.lazyderef NewHyps V2862))
                V2862 (freeze (shen.t*-hyps Hyp NewHyps V2862 V2863)))))))
           'false))
         Case))
       Case))
     Case))
   Case)))

(DEFUN shen.show (V2876 V2877 V2878 V2879)
 (COND
  ((shen.wrapper shen.*spy*)
   (do (shen.line)
    (do (shen.show-p (shen.deref V2876 V2878))
     (do (nl 1)
      (do (nl 1)
       (do (shen.show-assumptions (shen.deref V2877 V2878) 1)
        (do
         (shen.prhush
          "
> "
          (stoutput))
         (do (shen.pause-for-user) (thaw V2879)))))))))
  (T (thaw V2879))))

(DEFUN shen.line NIL
 (LET ((Infs (inferences)))
  (shen.prhush
   (cn "____________________________________________________________ "
    (shen.app Infs
     (cn " inference"
      (shen.app (IF (shen.ABSEQUAL 1 Infs) "" "s")
       " 
?- "
       'shen.a))
     'shen.a))
   (stoutput))))

(DEFUN shen.show-p (V2880)
 (COND
  ((AND (CONSP V2880)
    (AND (CONSP (CDR V2880))
     (AND (EQ '|:| (CAR (CDR V2880)))
      (AND (CONSP (CDR (CDR V2880))) (NULL (CDR (CDR (CDR V2880))))))))
   (shen.prhush
    (shen.app (CAR V2880)
     (cn " : " (shen.app (CAR (CDR (CDR V2880))) "" 'shen.r)) 'shen.r)
    (stoutput)))
  (T (shen.prhush (shen.app V2880 "" 'shen.r) (stoutput)))))

(DEFUN shen.show-assumptions (V2883 V2884)
 (COND ((NULL V2883) 'shen.skip)
  ((CONSP V2883)
   (do (shen.prhush (shen.app V2884 ". " 'shen.a) (stoutput))
    (do (shen.show-p (CAR V2883))
     (do (nl 1) (shen.show-assumptions (CDR V2883) (1+ V2884))))))
  (T (shen.sys-error 'shen.show-assumptions))))

(DEFUN shen.pause-for-user NIL
 (LET ((Byte (read-byte (stinput))))
  (IF (shen.ABSEQUAL Byte 94)
   (simple-error
    "input aborted
")
   (nl 1))))

(DEFUN shen.typedf? (V2885) (cons? (assoc V2885 shen.*signedfuncs*)))

(DEFUN shen.sigf (V2886) (concat 'shen.type-signature-of- V2886))

(DEFUN shen.placeholder NIL (gensym '&&))

(DEFUN shen.base (V2887 V2888 V2889 V2890)
 (LET
  ((Case
    (LET ((V2599 (shen.lazyderef V2888 V2889)))
     (IF (EQ 'number V2599)
      (do (shen.incinfs)
       (fwhen (number? (shen.lazyderef V2887 V2889)) V2889 V2890))
      (IF
       (AND (ARRAYP V2599) (NOT (STRINGP V2599))
        (EQ (AREF V2599 0) 'shen.pvar))
       (do (shen.bindv V2599 'number V2889)
        (LET
         ((Result
           (do (shen.incinfs)
            (fwhen (number? (shen.lazyderef V2887 V2889)) V2889 V2890))))
         (do (shen.unbindv V2599 V2889) Result)))
       'false)))))
  (IF (shen.ABSEQUAL Case 'false)
   (LET
    ((Case
      (LET ((V2600 (shen.lazyderef V2888 V2889)))
       (IF (EQ 'boolean V2600)
        (do (shen.incinfs)
         (fwhen (boolean? (shen.lazyderef V2887 V2889)) V2889 V2890))
        (IF
         (AND (ARRAYP V2600) (NOT (STRINGP V2600))
          (EQ (AREF V2600 0) 'shen.pvar))
         (do (shen.bindv V2600 'boolean V2889)
          (LET
           ((Result
             (do (shen.incinfs)
              (fwhen (boolean? (shen.lazyderef V2887 V2889)) V2889 V2890))))
           (do (shen.unbindv V2600 V2889) Result)))
         'false)))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET
      ((Case
        (LET ((V2601 (shen.lazyderef V2888 V2889)))
         (IF (EQ 'string V2601)
          (do (shen.incinfs)
           (fwhen (string? (shen.lazyderef V2887 V2889)) V2889 V2890))
          (IF
           (AND (ARRAYP V2601) (NOT (STRINGP V2601))
            (EQ (AREF V2601 0) 'shen.pvar))
           (do (shen.bindv V2601 'string V2889)
            (LET
             ((Result
               (do (shen.incinfs)
                (fwhen (string? (shen.lazyderef V2887 V2889)) V2889 V2890))))
             (do (shen.unbindv V2601 V2889) Result)))
           'false)))))
      (IF (shen.ABSEQUAL Case 'false)
       (LET
        ((Case
          (LET ((V2602 (shen.lazyderef V2888 V2889)))
           (IF (EQ 'symbol V2602)
            (do (shen.incinfs)
             (fwhen (symbol? (shen.lazyderef V2887 V2889)) V2889
              (freeze
               (fwhen (not (shen.ue? (shen.lazyderef V2887 V2889))) V2889
                V2890))))
            (IF
             (AND (ARRAYP V2602) (NOT (STRINGP V2602))
              (EQ (AREF V2602 0) 'shen.pvar))
             (do (shen.bindv V2602 'symbol V2889)
              (LET
               ((Result
                 (do (shen.incinfs)
                  (fwhen (symbol? (shen.lazyderef V2887 V2889)) V2889
                   (freeze
                    (fwhen (not (shen.ue? (shen.lazyderef V2887 V2889))) V2889
                     V2890))))))
               (do (shen.unbindv V2602 V2889) Result)))
             'false)))))
        (IF (shen.ABSEQUAL Case 'false)
         (LET ((V2603 (shen.lazyderef V2887 V2889)))
          (IF (NULL V2603)
           (LET ((V2604 (shen.lazyderef V2888 V2889)))
            (IF (CONSP V2604)
             (LET ((V2605 (shen.lazyderef (CAR V2604) V2889)))
              (IF (EQ 'list V2605)
               (LET ((V2606 (shen.lazyderef (CDR V2604) V2889)))
                (IF (CONSP V2606)
                 (LET ((A (CAR V2606)))
                  (LET ((V2607 (shen.lazyderef (CDR V2606) V2889)))
                   (IF (NULL V2607) (do (shen.incinfs) (thaw V2890))
                    (IF
                     (AND (ARRAYP V2607) (NOT (STRINGP V2607))
                      (EQ (AREF V2607 0) 'shen.pvar))
                     (do (shen.bindv V2607 NIL V2889)
                      (LET ((Result (do (shen.incinfs) (thaw V2890))))
                       (do (shen.unbindv V2607 V2889) Result)))
                     'false))))
                 (IF
                  (AND (ARRAYP V2606) (NOT (STRINGP V2606))
                   (EQ (AREF V2606 0) 'shen.pvar))
                  (LET ((A (shen.newpv V2889)))
                   (do (shen.bindv V2606 (CONS A NIL) V2889)
                    (LET ((Result (do (shen.incinfs) (thaw V2890))))
                     (do (shen.unbindv V2606 V2889) Result))))
                  'false)))
               (IF
                (AND (ARRAYP V2605) (NOT (STRINGP V2605))
                 (EQ (AREF V2605 0) 'shen.pvar))
                (do (shen.bindv V2605 'list V2889)
                 (LET
                  ((Result
                    (LET ((V2608 (shen.lazyderef (CDR V2604) V2889)))
                     (IF (CONSP V2608)
                      (LET ((A (CAR V2608)))
                       (LET ((V2609 (shen.lazyderef (CDR V2608) V2889)))
                        (IF (NULL V2609) (do (shen.incinfs) (thaw V2890))
                         (IF
                          (AND (ARRAYP V2609) (NOT (STRINGP V2609))
                           (EQ (AREF V2609 0) 'shen.pvar))
                          (do (shen.bindv V2609 NIL V2889)
                           (LET ((Result (do (shen.incinfs) (thaw V2890))))
                            (do (shen.unbindv V2609 V2889) Result)))
                          'false))))
                      (IF
                       (AND (ARRAYP V2608) (NOT (STRINGP V2608))
                        (EQ (AREF V2608 0) 'shen.pvar))
                       (LET ((A (shen.newpv V2889)))
                        (do (shen.bindv V2608 (CONS A NIL) V2889)
                         (LET ((Result (do (shen.incinfs) (thaw V2890))))
                          (do (shen.unbindv V2608 V2889) Result))))
                       'false)))))
                  (do (shen.unbindv V2605 V2889) Result)))
                'false)))
             (IF
              (AND (ARRAYP V2604) (NOT (STRINGP V2604))
               (EQ (AREF V2604 0) 'shen.pvar))
              (LET ((A (shen.newpv V2889)))
               (do (shen.bindv V2604 (CONS 'list (CONS A NIL)) V2889)
                (LET ((Result (do (shen.incinfs) (thaw V2890))))
                 (do (shen.unbindv V2604 V2889) Result))))
              'false)))
           'false))
         Case))
       Case))
     Case))
   Case)))

(DEFUN shen.by_hypothesis (V2891 V2892 V2893 V2894 V2895)
 (LET
  ((Case
    (LET ((V2590 (shen.lazyderef V2893 V2894)))
     (IF (CONSP V2590)
      (LET ((V2591 (shen.lazyderef (CAR V2590) V2894)))
       (IF (CONSP V2591)
        (LET ((Y (CAR V2591)))
         (LET ((V2592 (shen.lazyderef (CDR V2591) V2894)))
          (IF (CONSP V2592)
           (LET ((V2593 (shen.lazyderef (CAR V2592) V2894)))
            (IF (EQ '|:| V2593)
             (LET ((V2594 (shen.lazyderef (CDR V2592) V2894)))
              (IF (CONSP V2594)
               (LET ((B (CAR V2594)))
                (LET ((V2595 (shen.lazyderef (CDR V2594) V2894)))
                 (IF (NULL V2595)
                  (do (shen.incinfs)
                   (identical V2891 Y V2894
                    (freeze (unify! V2892 B V2894 V2895))))
                  'false)))
               'false))
             'false))
           'false)))
        'false))
      'false))))
  (IF (shen.ABSEQUAL Case 'false)
   (LET ((V2596 (shen.lazyderef V2893 V2894)))
    (IF (CONSP V2596)
     (LET ((Hyp (CDR V2596)))
      (do (shen.incinfs) (shen.by_hypothesis V2891 V2892 Hyp V2894 V2895)))
     'false))
   Case)))

(DEFUN shen.t*-def (V2896 V2897 V2898 V2899 V2900)
 (LET ((V2584 (shen.lazyderef V2896 V2899)))
  (IF (CONSP V2584)
   (LET ((V2585 (shen.lazyderef (CAR V2584) V2899)))
    (IF (EQ 'define V2585)
     (LET ((V2586 (shen.lazyderef (CDR V2584) V2899)))
      (IF (CONSP V2586)
       (LET ((F (CAR V2586)))
        (LET ((X (CDR V2586)))
         (LET ((E (shen.newpv V2899)))
          (do (shen.incinfs)
           (shen.t*-defh
            (compile 'shen.<sig+rules> X
             #'(LAMBDA (E)
                (IF (CONSP E)
                 (simple-error
                  (cn "parse error here: "
                   (shen.app E
                    "
"
                    'shen.s)))
                 (simple-error
                  "parse error
"))))
            F V2897 V2898 V2899 V2900)))))
       'false))
     'false))
   'false)))

(DEFUN shen.t*-defh (V2901 V2902 V2903 V2904 V2905 V2906)
 (LET ((V2580 (shen.lazyderef V2901 V2905)))
  (IF (CONSP V2580)
   (LET ((Sig (CAR V2580)))
    (LET ((Rules (CDR V2580)))
     (do (shen.incinfs)
      (shen.t*-defhh Sig (shen.ue-sig Sig) V2902 V2903 V2904 Rules V2905
       V2906))))
   'false)))

(DEFUN shen.t*-defhh (V2907 V2908 V2909 V2910 V2911 V2912 V2913 V2914)
 (do (shen.incinfs)
  (shen.t*-rules V2912 V2908 1 V2909
   (CONS (CONS V2909 (CONS '|:| (CONS V2908 NIL))) V2911) V2913
   (freeze (shen.memo V2909 V2907 V2910 V2913 V2914)))))

(DEFUN shen.memo (V2915 V2916 V2917 V2918 V2919)
 (LET ((Jnk (shen.newpv V2918)))
  (do (shen.incinfs)
   (unify! V2917 V2916 V2918
    (freeze
     (bind Jnk
      (declare (shen.lazyderef V2915 V2918) (shen.lazyderef V2917 V2918)) V2918
      V2919))))))

(DEFUN shen.<sig+rules> (V2924)
 (LET
  ((Result
    (LET ((Parse_shen.<signature> (shen.<signature> V2924)))
     (IF (NOT (EQ (fail) Parse_shen.<signature>))
      (LET ((Parse_shen.<rules> (shen.<rules> Parse_shen.<signature>)))
       (IF (NOT (EQ (fail) Parse_shen.<rules>))
        (shen.pair (CAR Parse_shen.<rules>)
         (CONS (shen.hdtl Parse_shen.<signature>)
          (shen.hdtl Parse_shen.<rules>)))
        (fail)))
      (fail)))))
  (IF (EQ Result (fail)) (fail) Result)))

(DEFUN shen.ue (V2925)
 (COND
  ((AND (CONSP V2925)
    (AND (CONSP (CDR V2925))
     (AND (NULL (CDR (CDR V2925))) (shen.ABSEQUAL (CAR V2925) 'protect))))
   V2925)
  ((CONSP V2925) (map 'shen.ue V2925))
  ((shen.wrapper (variable? V2925)) (concat '&& V2925)) (T V2925)))

(DEFUN shen.ue-sig (V2926)
 (COND ((CONSP V2926) (map 'shen.ue-sig V2926))
  ((shen.wrapper (variable? V2926)) (concat '&&& V2926)) (T V2926)))

(DEFUN shen.ues (V2931)
 (COND ((shen.wrapper (shen.ue? V2931)) (CONS V2931 NIL))
  ((CONSP V2931) (union (shen.ues (CAR V2931)) (shen.ues (CDR V2931))))
  (T NIL)))

(DEFUN shen.ue? (V2932) (and (symbol? V2932) (shen.ue-h? (str V2932))))

(DEFUN shen.ue-h? (V2939)
 (COND
  ((AND (shen.wrapper (shen.+string? V2939))
    (AND (EQUAL "&" (pos V2939 0))
     (AND (NOT (STRING-EQUAL (tlstr V2939) ""))
      (EQUAL "&" (pos (tlstr V2939) 0)))))
   'true)
  (T 'false)))

(DEFUN shen.t*-rules (V2940 V2941 V2942 V2943 V2944 V2945 V2946)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET
    ((Case
      (LET ((V2555 (shen.lazyderef V2940 V2945)))
       (IF (NULL V2555) (do (shen.incinfs) (thaw V2946)) 'false))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET
      ((Case
        (LET ((V2556 (shen.lazyderef V2940 V2945)))
         (IF (CONSP V2556)
          (LET ((V2557 (shen.lazyderef (CAR V2556) V2945)))
           (IF (CONSP V2557)
            (LET ((V2558 (shen.lazyderef (CAR V2557) V2945)))
             (IF (NULL V2558)
              (LET ((V2559 (shen.lazyderef (CDR V2557) V2945)))
               (IF (CONSP V2559)
                (LET ((Action (CAR V2559)))
                 (LET ((V2560 (shen.lazyderef (CDR V2559) V2945)))
                  (IF (NULL V2560)
                   (LET ((Rules (CDR V2556)))
                    (LET ((V2561 (shen.lazyderef V2941 V2945)))
                     (IF (CONSP V2561)
                      (LET ((V2562 (shen.lazyderef (CAR V2561) V2945)))
                       (IF (EQ '--> V2562)
                        (LET ((V2563 (shen.lazyderef (CDR V2561) V2945)))
                         (IF (CONSP V2563)
                          (LET ((A (CAR V2563)))
                           (LET ((V2564 (shen.lazyderef (CDR V2563) V2945)))
                            (IF (NULL V2564)
                             (do (shen.incinfs)
                              (shen.t*-rule
                               (CONS NIL (CONS (shen.ue Action) NIL)) A V2944
                               V2945
                               (freeze
                                (cut Throwcontrol V2945
                                 (freeze
                                  (shen.t*-rules Rules A (1+ V2942) V2943 V2944
                                   V2945 V2946))))))
                             'false)))
                          'false))
                        'false))
                      'false)))
                   'false)))
                'false))
              'false))
            'false))
          'false))))
      (IF (shen.ABSEQUAL Case 'false)
       (LET
        ((Case
          (LET ((V2565 (shen.lazyderef V2940 V2945)))
           (IF (CONSP V2565)
            (LET ((Rule (CAR V2565)))
             (LET ((Rules (CDR V2565)))
              (do (shen.incinfs)
               (shen.t*-rule (shen.ue Rule) V2941 V2944 V2945
                (freeze
                 (cut Throwcontrol V2945
                  (freeze
                   (shen.t*-rules Rules V2941 (1+ V2942) V2943 V2944 V2945
                    V2946))))))))
            'false))))
        (IF (shen.ABSEQUAL Case 'false)
         (LET ((Err (shen.newpv V2945)))
          (do (shen.incinfs)
           (bind Err
            (simple-error
             (cn "type error in rule "
              (shen.app (shen.lazyderef V2942 V2945)
               (cn " of " (shen.app (shen.lazyderef V2943 V2945) "" 'shen.a))
               'shen.a)))
            V2945 V2946)))
         Case))
       Case))
     Case)))))

(DEFUN shen.t*-rule (V2947 V2948 V2949 V2950 V2951)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET
    ((Case
      (LET ((V2537 (shen.lazyderef V2947 V2950)))
       (IF (CONSP V2537)
        (LET ((V2538 (shen.lazyderef (CAR V2537) V2950)))
         (IF (NULL V2538)
          (LET ((V2539 (shen.lazyderef (CDR V2537) V2950)))
           (IF (CONSP V2539)
            (LET ((Action (CAR V2539)))
             (LET ((V2540 (shen.lazyderef (CDR V2539) V2950)))
              (IF (NULL V2540)
               (do (shen.incinfs)
                (cut Throwcontrol V2950
                 (freeze
                  (shen.t*-action (shen.curry Action) V2948 V2949 V2950
                   V2951))))
               'false)))
            'false))
          'false))
        'false))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET ((V2541 (shen.lazyderef V2947 V2950)))
      (IF (CONSP V2541)
       (LET ((V2542 (shen.lazyderef (CAR V2541) V2950)))
        (IF (CONSP V2542)
         (LET ((Pattern (CAR V2542)))
          (LET ((Patterns (CDR V2542)))
           (LET ((V2543 (shen.lazyderef (CDR V2541) V2950)))
            (IF (CONSP V2543)
             (LET ((Action (CAR V2543)))
              (LET ((V2544 (shen.lazyderef (CDR V2543) V2950)))
               (IF (NULL V2544)
                (LET ((V2545 (shen.lazyderef V2948 V2950)))
                 (IF (CONSP V2545)
                  (LET ((A (CAR V2545)))
                   (LET ((V2546 (shen.lazyderef (CDR V2545) V2950)))
                    (IF (CONSP V2546)
                     (LET ((V2547 (shen.lazyderef (CAR V2546) V2950)))
                      (IF (EQ '--> V2547)
                       (LET ((V2548 (shen.lazyderef (CDR V2546) V2950)))
                        (IF (CONSP V2548)
                         (LET ((B (CAR V2548)))
                          (LET ((V2549 (shen.lazyderef (CDR V2548) V2950)))
                           (IF (NULL V2549)
                            (do (shen.incinfs)
                             (shen.t*-pattern Pattern A V2950
                              (freeze
                               (cut Throwcontrol V2950
                                (freeze
                                 (shen.t*-rule
                                  (CONS Patterns (CONS Action NIL)) B
                                  (CONS (CONS Pattern (CONS '|:| (CONS A NIL)))
                                   V2949)
                                  V2950 V2951))))))
                            'false)))
                         'false))
                       'false))
                     'false)))
                  'false))
                'false)))
             'false))))
         'false))
       'false))
     Case)))))

(DEFUN shen.t*-action (V2952 V2953 V2954 V2955 V2956)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET
    ((Case
      (LET ((V2514 (shen.lazyderef V2952 V2955)))
       (IF (CONSP V2514)
        (LET ((V2515 (shen.lazyderef (CAR V2514) V2955)))
         (IF (EQ 'where V2515)
          (LET ((V2516 (shen.lazyderef (CDR V2514) V2955)))
           (IF (CONSP V2516)
            (LET ((P (CAR V2516)))
             (LET ((V2517 (shen.lazyderef (CDR V2516) V2955)))
              (IF (CONSP V2517)
               (LET ((Action (CAR V2517)))
                (LET ((V2518 (shen.lazyderef (CDR V2517) V2955)))
                 (IF (NULL V2518)
                  (do (shen.incinfs)
                   (cut Throwcontrol V2955
                    (freeze
                     (shen.t* (CONS P (CONS '|:| (CONS 'boolean NIL))) V2954
                      V2955
                      (freeze
                       (cut Throwcontrol V2955
                        (freeze
                         (shen.t*-action Action V2953
                          (CONS (CONS P (CONS '|:| (CONS 'verified NIL)))
                           V2954)
                          V2955 V2956))))))))
                  'false)))
               'false)))
            'false))
          'false))
        'false))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET
      ((Case
        (LET ((V2519 (shen.lazyderef V2952 V2955)))
         (IF (CONSP V2519)
          (LET ((V2520 (shen.lazyderef (CAR V2519) V2955)))
           (IF (EQ 'shen.choicepoint! V2520)
            (LET ((V2521 (shen.lazyderef (CDR V2519) V2955)))
             (IF (CONSP V2521)
              (LET ((V2522 (shen.lazyderef (CAR V2521) V2955)))
               (IF (CONSP V2522)
                (LET ((V2523 (shen.lazyderef (CAR V2522) V2955)))
                 (IF (CONSP V2523)
                  (LET ((V2524 (shen.lazyderef (CAR V2523) V2955)))
                   (IF (EQ 'fail-if V2524)
                    (LET ((V2525 (shen.lazyderef (CDR V2523) V2955)))
                     (IF (CONSP V2525)
                      (LET ((F (CAR V2525)))
                       (LET ((V2526 (shen.lazyderef (CDR V2525) V2955)))
                        (IF (NULL V2526)
                         (LET ((V2527 (shen.lazyderef (CDR V2522) V2955)))
                          (IF (CONSP V2527)
                           (LET ((Action (CAR V2527)))
                            (LET ((V2528 (shen.lazyderef (CDR V2527) V2955)))
                             (IF (NULL V2528)
                              (LET ((V2529 (shen.lazyderef (CDR V2521) V2955)))
                               (IF (NULL V2529)
                                (do (shen.incinfs)
                                 (cut Throwcontrol V2955
                                  (freeze
                                   (shen.t*-action
                                    (CONS 'where
                                     (CONS
                                      (CONS 'not
                                       (CONS (CONS F (CONS Action NIL)) NIL))
                                      (CONS Action NIL)))
                                    V2953 V2954 V2955 V2956))))
                                'false))
                              'false)))
                           'false))
                         'false)))
                      'false))
                    'false))
                  'false))
                'false))
              'false))
            'false))
          'false))))
      (IF (shen.ABSEQUAL Case 'false)
       (LET
        ((Case
          (LET ((V2530 (shen.lazyderef V2952 V2955)))
           (IF (CONSP V2530)
            (LET ((V2531 (shen.lazyderef (CAR V2530) V2955)))
             (IF (EQ 'shen.choicepoint! V2531)
              (LET ((V2532 (shen.lazyderef (CDR V2530) V2955)))
               (IF (CONSP V2532)
                (LET ((Action (CAR V2532)))
                 (LET ((V2533 (shen.lazyderef (CDR V2532) V2955)))
                  (IF (NULL V2533)
                   (do (shen.incinfs)
                    (cut Throwcontrol V2955
                     (freeze
                      (shen.t*-action
                       (CONS 'where
                        (CONS
                         (CONS 'not
                          (CONS
                           (CONS (CONS '= (CONS Action NIL))
                            (CONS (CONS 'fail NIL) NIL))
                           NIL))
                         (CONS Action NIL)))
                       V2953 V2954 V2955 V2956))))
                   'false)))
                'false))
              'false))
            'false))))
        (IF (shen.ABSEQUAL Case 'false)
         (do (shen.incinfs)
          (shen.t* (CONS V2952 (CONS '|:| (CONS V2953 NIL))) V2954 V2955
           V2956))
         Case))
       Case))
     Case)))))

(DEFUN shen.t*-pattern (V2957 V2958 V2959 V2960)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET ((Hyp (shen.newpv V2959)))
    (do (shen.incinfs)
     (shen.tms->hyp (shen.ues V2957) Hyp V2959
      (freeze
       (cut Throwcontrol V2959
        (freeze
         (shen.t* (CONS V2957 (CONS '|:| (CONS V2958 NIL))) Hyp V2959
          V2960))))))))))

(DEFUN shen.tms->hyp (V2961 V2962 V2963 V2964)
 (LET
  ((Case
    (LET ((V2498 (shen.lazyderef V2961 V2963)))
     (IF (NULL V2498)
      (LET ((V2499 (shen.lazyderef V2962 V2963)))
       (IF (NULL V2499) (do (shen.incinfs) (thaw V2964))
        (IF
         (AND (ARRAYP V2499) (NOT (STRINGP V2499))
          (EQ (AREF V2499 0) 'shen.pvar))
         (do (shen.bindv V2499 NIL V2963)
          (LET ((Result (do (shen.incinfs) (thaw V2964))))
           (do (shen.unbindv V2499 V2963) Result)))
         'false)))
      'false))))
  (IF (shen.ABSEQUAL Case 'false)
   (LET ((V2500 (shen.lazyderef V2961 V2963)))
    (IF (CONSP V2500)
     (LET ((Tm2495 (CAR V2500)))
      (LET ((Tms (CDR V2500)))
       (LET ((V2501 (shen.lazyderef V2962 V2963)))
        (IF (CONSP V2501)
         (LET ((V2502 (shen.lazyderef (CAR V2501) V2963)))
          (IF (CONSP V2502)
           (LET ((Tm (CAR V2502)))
            (LET ((V2503 (shen.lazyderef (CDR V2502) V2963)))
             (IF (CONSP V2503)
              (LET ((V2504 (shen.lazyderef (CAR V2503) V2963)))
               (IF (EQ '|:| V2504)
                (LET ((V2505 (shen.lazyderef (CDR V2503) V2963)))
                 (IF (CONSP V2505)
                  (LET ((A (CAR V2505)))
                   (LET ((V2506 (shen.lazyderef (CDR V2505) V2963)))
                    (IF (NULL V2506)
                     (LET ((Hyp (CDR V2501)))
                      (do (shen.incinfs)
                       (unify! Tm Tm2495 V2963
                        (freeze (shen.tms->hyp Tms Hyp V2963 V2964)))))
                     (IF
                      (AND (ARRAYP V2506) (NOT (STRINGP V2506))
                       (EQ (AREF V2506 0) 'shen.pvar))
                      (do (shen.bindv V2506 NIL V2963)
                       (LET
                        ((Result
                          (LET ((Hyp (CDR V2501)))
                           (do (shen.incinfs)
                            (unify! Tm Tm2495 V2963
                             (freeze (shen.tms->hyp Tms Hyp V2963 V2964)))))))
                        (do (shen.unbindv V2506 V2963) Result)))
                      'false))))
                  (IF
                   (AND (ARRAYP V2505) (NOT (STRINGP V2505))
                    (EQ (AREF V2505 0) 'shen.pvar))
                   (LET ((A (shen.newpv V2963)))
                    (do (shen.bindv V2505 (CONS A NIL) V2963)
                     (LET
                      ((Result
                        (LET ((Hyp (CDR V2501)))
                         (do (shen.incinfs)
                          (unify! Tm Tm2495 V2963
                           (freeze (shen.tms->hyp Tms Hyp V2963 V2964)))))))
                      (do (shen.unbindv V2505 V2963) Result))))
                   'false)))
                (IF
                 (AND (ARRAYP V2504) (NOT (STRINGP V2504))
                  (EQ (AREF V2504 0) 'shen.pvar))
                 (do (shen.bindv V2504 '|:| V2963)
                  (LET
                   ((Result
                     (LET ((V2507 (shen.lazyderef (CDR V2503) V2963)))
                      (IF (CONSP V2507)
                       (LET ((A (CAR V2507)))
                        (LET ((V2508 (shen.lazyderef (CDR V2507) V2963)))
                         (IF (NULL V2508)
                          (LET ((Hyp (CDR V2501)))
                           (do (shen.incinfs)
                            (unify! Tm Tm2495 V2963
                             (freeze (shen.tms->hyp Tms Hyp V2963 V2964)))))
                          (IF
                           (AND (ARRAYP V2508) (NOT (STRINGP V2508))
                            (EQ (AREF V2508 0) 'shen.pvar))
                           (do (shen.bindv V2508 NIL V2963)
                            (LET
                             ((Result
                               (LET ((Hyp (CDR V2501)))
                                (do (shen.incinfs)
                                 (unify! Tm Tm2495 V2963
                                  (freeze
                                   (shen.tms->hyp Tms Hyp V2963 V2964)))))))
                             (do (shen.unbindv V2508 V2963) Result)))
                           'false))))
                       (IF
                        (AND (ARRAYP V2507) (NOT (STRINGP V2507))
                         (EQ (AREF V2507 0) 'shen.pvar))
                        (LET ((A (shen.newpv V2963)))
                         (do (shen.bindv V2507 (CONS A NIL) V2963)
                          (LET
                           ((Result
                             (LET ((Hyp (CDR V2501)))
                              (do (shen.incinfs)
                               (unify! Tm Tm2495 V2963
                                (freeze
                                 (shen.tms->hyp Tms Hyp V2963 V2964)))))))
                           (do (shen.unbindv V2507 V2963) Result))))
                        'false)))))
                   (do (shen.unbindv V2504 V2963) Result)))
                 'false)))
              (IF
               (AND (ARRAYP V2503) (NOT (STRINGP V2503))
                (EQ (AREF V2503 0) 'shen.pvar))
               (LET ((A (shen.newpv V2963)))
                (do (shen.bindv V2503 (CONS '|:| (CONS A NIL)) V2963)
                 (LET
                  ((Result
                    (LET ((Hyp (CDR V2501)))
                     (do (shen.incinfs)
                      (unify! Tm Tm2495 V2963
                       (freeze (shen.tms->hyp Tms Hyp V2963 V2964)))))))
                  (do (shen.unbindv V2503 V2963) Result))))
               'false))))
           (IF
            (AND (ARRAYP V2502) (NOT (STRINGP V2502))
             (EQ (AREF V2502 0) 'shen.pvar))
            (LET ((Tm (shen.newpv V2963)))
             (LET ((A (shen.newpv V2963)))
              (do (shen.bindv V2502 (CONS Tm (CONS '|:| (CONS A NIL))) V2963)
               (LET
                ((Result
                  (LET ((Hyp (CDR V2501)))
                   (do (shen.incinfs)
                    (unify! Tm Tm2495 V2963
                     (freeze (shen.tms->hyp Tms Hyp V2963 V2964)))))))
                (do (shen.unbindv V2502 V2963) Result)))))
            'false)))
         (IF
          (AND (ARRAYP V2501) (NOT (STRINGP V2501))
           (EQ (AREF V2501 0) 'shen.pvar))
          (LET ((Tm (shen.newpv V2963)))
           (LET ((A (shen.newpv V2963)))
            (LET ((Hyp (shen.newpv V2963)))
             (do
              (shen.bindv V2501 (CONS (CONS Tm (CONS '|:| (CONS A NIL))) Hyp)
               V2963)
              (LET
               ((Result
                 (do (shen.incinfs)
                  (unify! Tm Tm2495 V2963
                   (freeze (shen.tms->hyp Tms Hyp V2963 V2964))))))
               (do (shen.unbindv V2501 V2963) Result))))))
          'false)))))
     'false))
   Case)))

(DEFUN findall (V2965 V2966 V2967 V2968 V2969)
 (LET ((B (shen.newpv V2968)))
  (LET ((A (shen.newpv V2968)))
   (do (shen.incinfs)
    (bind A (gensym 'shen.a) V2968
     (freeze
      (bind B (set (shen.lazyderef A V2968) NIL) V2968
       (freeze (shen.findallhelp V2965 V2966 V2967 A V2968 V2969)))))))))

(DEFUN shen.findallhelp (V2970 V2971 V2972 V2973 V2974 V2975)
 (LET
  ((Case
    (do (shen.incinfs)
     (call V2971 V2974
      (freeze
       (shen.remember V2973 V2970 V2974
        (freeze (fwhen 'false V2974 V2975))))))))
  (IF (shen.ABSEQUAL Case 'false)
   (do (shen.incinfs)
    (bind V2972 (value (shen.lazyderef V2973 V2974)) V2974 V2975))
   Case)))

(DEFUN shen.remember (V2976 V2977 V2978 V2979)
 (LET ((B (shen.newpv V2978)))
  (do (shen.incinfs)
   (bind B
    (set (shen.deref V2976 V2978)
     (CONS (shen.deref V2977 V2978) (value (shen.deref V2976 V2978))))
    V2978 V2979))))

(DEFUN shen.t*-defcc (V2980 V2981 V2982 V2983 V2984)
 (LET ((V2471 (shen.lazyderef V2980 V2983)))
  (IF (CONSP V2471)
   (LET ((V2472 (shen.lazyderef (CAR V2471) V2983)))
    (IF (EQ 'defcc V2472)
     (LET ((V2473 (shen.lazyderef (CDR V2471) V2983)))
      (IF (CONSP V2473)
       (LET ((F (CAR V2473)))
        (LET ((V2474 (shen.lazyderef (CDR V2473) V2983)))
         (IF (CONSP V2474)
          (LET ((V2475 (shen.lazyderef (CAR V2474) V2983)))
           (IF (EQ '{ V2475)
            (LET ((V2476 (shen.lazyderef (CDR V2474) V2983)))
             (IF (CONSP V2476)
              (LET ((V2477 (shen.lazyderef (CAR V2476) V2983)))
               (IF (CONSP V2477)
                (LET ((V2478 (shen.lazyderef (CAR V2477) V2983)))
                 (IF (EQ 'list V2478)
                  (LET ((V2479 (shen.lazyderef (CDR V2477) V2983)))
                   (IF (CONSP V2479)
                    (LET ((A (CAR V2479)))
                     (LET ((V2480 (shen.lazyderef (CDR V2479) V2983)))
                      (IF (NULL V2480)
                       (LET ((V2481 (shen.lazyderef (CDR V2476) V2983)))
                        (IF (CONSP V2481)
                         (LET ((V2482 (shen.lazyderef (CAR V2481) V2983)))
                          (IF (EQ '==> V2482)
                           (LET ((V2483 (shen.lazyderef (CDR V2481) V2983)))
                            (IF (CONSP V2483)
                             (LET ((B (CAR V2483)))
                              (LET ((V2484 (shen.lazyderef (CDR V2483) V2983)))
                               (IF (CONSP V2484)
                                (LET
                                 ((V2485 (shen.lazyderef (CAR V2484) V2983)))
                                 (IF (EQ '} V2485)
                                  (LET ((Rest (CDR V2484)))
                                   (do (shen.incinfs)
                                    (shen.t*-defcc-h
                                     (CONS 'defcc
                                      (CONS F
                                       (CONS
                                        (shen.ue
                                         (shen.demodulate
                                          (CONS (CONS 'list (CONS A NIL))
                                           (CONS '==> (CONS B NIL)))))
                                        (shen.ue
                                         (shen.split_cc_rules 'false
                                          (shen.plug-wildcards Rest) NIL)))))
                                     V2981 V2982 V2983 V2984)))
                                  'false))
                                'false)))
                             'false))
                           'false))
                         'false))
                       'false)))
                    'false))
                  'false))
                'false))
              'false))
            'false))
          'false)))
       'false))
     'false))
   'false)))

(DEFUN shen.plug-wildcards (V2985)
 (COND ((CONSP V2985) (map 'shen.plug-wildcards V2985))
  ((shen.ABSEQUAL V2985 '_) (gensym (intern "X"))) (T V2985)))

(DEFUN shen.t*-defcc-h (V2986 V2987 V2988 V2989 V2990)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET ((V2455 (shen.lazyderef V2986 V2989)))
    (IF (CONSP V2455)
     (LET ((V2456 (shen.lazyderef (CAR V2455) V2989)))
      (IF (EQ 'defcc V2456)
       (LET ((V2457 (shen.lazyderef (CDR V2455) V2989)))
        (IF (CONSP V2457)
         (LET ((F (CAR V2457)))
          (LET ((V2458 (shen.lazyderef (CDR V2457) V2989)))
           (IF (CONSP V2458)
            (LET ((V2459 (shen.lazyderef (CAR V2458) V2989)))
             (IF (CONSP V2459)
              (LET ((V2460 (shen.lazyderef (CAR V2459) V2989)))
               (IF (CONSP V2460)
                (LET ((V2461 (shen.lazyderef (CAR V2460) V2989)))
                 (IF (EQ 'list V2461)
                  (LET ((V2462 (shen.lazyderef (CDR V2460) V2989)))
                   (IF (CONSP V2462)
                    (LET ((A (CAR V2462)))
                     (LET ((V2463 (shen.lazyderef (CDR V2462) V2989)))
                      (IF (NULL V2463)
                       (LET ((V2464 (shen.lazyderef (CDR V2459) V2989)))
                        (IF (CONSP V2464)
                         (LET ((V2465 (shen.lazyderef (CAR V2464) V2989)))
                          (IF (EQ '==> V2465)
                           (LET ((V2466 (shen.lazyderef (CDR V2464) V2989)))
                            (IF (CONSP V2466)
                             (LET ((B (CAR V2466)))
                              (LET ((V2467 (shen.lazyderef (CDR V2466) V2989)))
                               (IF (NULL V2467)
                                (LET ((Rules (CDR V2458)))
                                 (LET ((Declare (shen.newpv V2989)))
                                  (do (shen.incinfs)
                                   (cut Throwcontrol V2989
                                    (freeze
                                     (shen.tc-rules F Rules
                                      (CONS 'list (CONS A NIL)) B
                                      (CONS
                                       (CONS F
                                        (CONS '|:|
                                         (CONS
                                          (CONS (CONS 'list (CONS A NIL))
                                           (CONS '==> (CONS B NIL)))
                                          NIL)))
                                       V2988)
                                      1 V2989
                                      (freeze
                                       (unify V2987
                                        (CONS (CONS 'list (CONS A NIL))
                                         (CONS '==> (CONS B NIL)))
                                        V2989
                                        (freeze
                                         (bind Declare
                                          (declare (shen.lazyderef F V2989)
                                           (CONS
                                            (CONS 'list
                                             (CONS (shen.lazyderef A V2989)
                                              NIL))
                                            (CONS '==>
                                             (CONS (shen.lazyderef B V2989)
                                              NIL))))
                                          V2989 V2990))))))))))
                                'false)))
                             'false))
                           'false))
                         'false))
                       'false)))
                    'false))
                  'false))
                'false))
              'false))
            'false)))
         'false))
       'false))
     'false)))))

(DEFUN shen.tc-rules (V2991 V2992 V2993 V2994 V2995 V2996 V2997 V2998)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET
    ((Case
      (LET ((V2446 (shen.lazyderef V2992 V2997)))
       (IF (NULL V2446) (do (shen.incinfs) (thaw V2998)) 'false))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET ((V2447 (shen.lazyderef V2992 V2997)))
      (IF (CONSP V2447)
       (LET ((Rule (CAR V2447)))
        (LET ((Rules (CDR V2447)))
         (LET ((V2448 (shen.lazyderef V2993 V2997)))
          (IF (CONSP V2448)
           (LET ((V2449 (shen.lazyderef (CAR V2448) V2997)))
            (IF (EQ 'list V2449)
             (LET ((V2450 (shen.lazyderef (CDR V2448) V2997)))
              (IF (CONSP V2450)
               (LET ((A (CAR V2450)))
                (LET ((V2451 (shen.lazyderef (CDR V2450) V2997)))
                 (IF (NULL V2451)
                  (LET ((M (shen.newpv V2997)))
                   (do (shen.incinfs)
                    (shen.tc-rule V2991 Rule A V2994 V2995 V2996 V2997
                     (freeze
                      (bind M (1+ (shen.deref V2996 V2997)) V2997
                       (freeze
                        (cut Throwcontrol V2997
                         (freeze
                          (shen.tc-rules V2991 Rules (CONS 'list (CONS A NIL))
                           V2994 V2995 M V2997 V2998)))))))))
                  'false)))
               'false))
             'false))
           'false))))
       'false))
     Case)))))

(DEFUN shen.tc-rule (V2999 V3000 V3001 V3002 V3003 V3004 V3005 V3006)
 (LET
  ((Case
    (do (shen.incinfs)
     (shen.check-defcc-rule V3000 V3001 V3002 V3003 V3005 V3006))))
  (IF (shen.ABSEQUAL Case 'false)
   (LET ((Err (shen.newpv V3005)))
    (do (shen.incinfs)
     (bind Err
      (simple-error
       (cn "type error in rule "
        (shen.app (shen.lazyderef V3004 V3005)
         (cn " of " (shen.app (shen.lazyderef V2999 V3005) "" 'shen.a))
         'shen.a)))
      V3005 V3006)))
   Case)))

(DEFUN shen.check-defcc-rule (V3007 V3008 V3009 V3010 V3011 V3012)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET ((V2431 (shen.lazyderef V3007 V3011)))
    (IF (CONSP V2431)
     (LET ((Syntax (CAR V2431)))
      (LET ((V2432 (shen.lazyderef (CDR V2431) V3011)))
       (IF (CONSP V2432)
        (LET ((Semantics (CAR V2432)))
         (LET ((V2433 (shen.lazyderef (CDR V2432) V3011)))
          (IF (NULL V2433)
           (LET ((SynHyps (shen.newpv V3011)))
            (do (shen.incinfs)
             (shen.syntax-hyps Syntax V3010 SynHyps V3008 V3011
              (freeze
               (cut Throwcontrol V3011
                (freeze
                 (shen.syntax-check Syntax V3008 SynHyps V3011
                  (freeze
                   (cut Throwcontrol V3011
                    (freeze
                     (shen.semantics-check Semantics V3009 SynHyps V3011
                      V3012)))))))))))
           'false)))
        'false)))
     'false)))))

(DEFUN shen.syntax-hyps (V3013 V3014 V3015 V3016 V3017 V3018)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET
    ((Case
      (LET ((V2416 (shen.lazyderef V3013 V3017)))
       (IF (NULL V2416) (do (shen.incinfs) (unify! V3015 V3014 V3017 V3018))
        'false))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET
      ((Case
        (LET ((V2417 (shen.lazyderef V3013 V3017)))
         (IF (CONSP V2417)
          (LET ((X2410 (CAR V2417)))
           (LET ((Y (CDR V2417)))
            (LET ((V2418 (shen.lazyderef V3015 V3017)))
             (IF (CONSP V2418)
              (LET ((V2419 (shen.lazyderef (CAR V2418) V3017)))
               (IF (CONSP V2419)
                (LET ((X (CAR V2419)))
                 (LET ((V2420 (shen.lazyderef (CDR V2419) V3017)))
                  (IF (CONSP V2420)
                   (LET ((V2421 (shen.lazyderef (CAR V2420) V3017)))
                    (IF (EQ '|:| V2421)
                     (LET ((V2422 (shen.lazyderef (CDR V2420) V3017)))
                      (IF (CONSP V2422)
                       (LET ((A2411 (CAR V2422)))
                        (LET ((V2423 (shen.lazyderef (CDR V2422) V3017)))
                         (IF (NULL V2423)
                          (LET ((SynHyps (CDR V2418)))
                           (do (shen.incinfs)
                            (unify! V3016 A2411 V3017
                             (freeze
                              (unify! X X2410 V3017
                               (freeze
                                (fwhen (shen.ue? (shen.deref X V3017)) V3017
                                 (freeze
                                  (cut Throwcontrol V3017
                                   (freeze
                                    (shen.syntax-hyps Y V3014 SynHyps V3016
                                     V3017 V3018)))))))))))
                          (IF
                           (AND (ARRAYP V2423) (NOT (STRINGP V2423))
                            (EQ (AREF V2423 0) 'shen.pvar))
                           (do (shen.bindv V2423 NIL V3017)
                            (LET
                             ((Result
                               (LET ((SynHyps (CDR V2418)))
                                (do (shen.incinfs)
                                 (unify! V3016 A2411 V3017
                                  (freeze
                                   (unify! X X2410 V3017
                                    (freeze
                                     (fwhen (shen.ue? (shen.deref X V3017))
                                      V3017
                                      (freeze
                                       (cut Throwcontrol V3017
                                        (freeze
                                         (shen.syntax-hyps Y V3014 SynHyps
                                          V3016 V3017 V3018)))))))))))))
                             (do (shen.unbindv V2423 V3017) Result)))
                           'false))))
                       (IF
                        (AND (ARRAYP V2422) (NOT (STRINGP V2422))
                         (EQ (AREF V2422 0) 'shen.pvar))
                        (LET ((A2411 (shen.newpv V3017)))
                         (do (shen.bindv V2422 (CONS A2411 NIL) V3017)
                          (LET
                           ((Result
                             (LET ((SynHyps (CDR V2418)))
                              (do (shen.incinfs)
                               (unify! V3016 A2411 V3017
                                (freeze
                                 (unify! X X2410 V3017
                                  (freeze
                                   (fwhen (shen.ue? (shen.deref X V3017)) V3017
                                    (freeze
                                     (cut Throwcontrol V3017
                                      (freeze
                                       (shen.syntax-hyps Y V3014 SynHyps V3016
                                        V3017 V3018)))))))))))))
                           (do (shen.unbindv V2422 V3017) Result))))
                        'false)))
                     (IF
                      (AND (ARRAYP V2421) (NOT (STRINGP V2421))
                       (EQ (AREF V2421 0) 'shen.pvar))
                      (do (shen.bindv V2421 '|:| V3017)
                       (LET
                        ((Result
                          (LET ((V2424 (shen.lazyderef (CDR V2420) V3017)))
                           (IF (CONSP V2424)
                            (LET ((A2411 (CAR V2424)))
                             (LET ((V2425 (shen.lazyderef (CDR V2424) V3017)))
                              (IF (NULL V2425)
                               (LET ((SynHyps (CDR V2418)))
                                (do (shen.incinfs)
                                 (unify! V3016 A2411 V3017
                                  (freeze
                                   (unify! X X2410 V3017
                                    (freeze
                                     (fwhen (shen.ue? (shen.deref X V3017))
                                      V3017
                                      (freeze
                                       (cut Throwcontrol V3017
                                        (freeze
                                         (shen.syntax-hyps Y V3014 SynHyps
                                          V3016 V3017 V3018)))))))))))
                               (IF
                                (AND (ARRAYP V2425) (NOT (STRINGP V2425))
                                 (EQ (AREF V2425 0) 'shen.pvar))
                                (do (shen.bindv V2425 NIL V3017)
                                 (LET
                                  ((Result
                                    (LET ((SynHyps (CDR V2418)))
                                     (do (shen.incinfs)
                                      (unify! V3016 A2411 V3017
                                       (freeze
                                        (unify! X X2410 V3017
                                         (freeze
                                          (fwhen
                                           (shen.ue? (shen.deref X V3017))
                                           V3017
                                           (freeze
                                            (cut Throwcontrol V3017
                                             (freeze
                                              (shen.syntax-hyps Y V3014 SynHyps
                                               V3016 V3017 V3018)))))))))))))
                                  (do (shen.unbindv V2425 V3017) Result)))
                                'false))))
                            (IF
                             (AND (ARRAYP V2424) (NOT (STRINGP V2424))
                              (EQ (AREF V2424 0) 'shen.pvar))
                             (LET ((A2411 (shen.newpv V3017)))
                              (do (shen.bindv V2424 (CONS A2411 NIL) V3017)
                               (LET
                                ((Result
                                  (LET ((SynHyps (CDR V2418)))
                                   (do (shen.incinfs)
                                    (unify! V3016 A2411 V3017
                                     (freeze
                                      (unify! X X2410 V3017
                                       (freeze
                                        (fwhen (shen.ue? (shen.deref X V3017))
                                         V3017
                                         (freeze
                                          (cut Throwcontrol V3017
                                           (freeze
                                            (shen.syntax-hyps Y V3014 SynHyps
                                             V3016 V3017 V3018)))))))))))))
                                (do (shen.unbindv V2424 V3017) Result))))
                             'false)))))
                        (do (shen.unbindv V2421 V3017) Result)))
                      'false)))
                   (IF
                    (AND (ARRAYP V2420) (NOT (STRINGP V2420))
                     (EQ (AREF V2420 0) 'shen.pvar))
                    (LET ((A2411 (shen.newpv V3017)))
                     (do (shen.bindv V2420 (CONS '|:| (CONS A2411 NIL)) V3017)
                      (LET
                       ((Result
                         (LET ((SynHyps (CDR V2418)))
                          (do (shen.incinfs)
                           (unify! V3016 A2411 V3017
                            (freeze
                             (unify! X X2410 V3017
                              (freeze
                               (fwhen (shen.ue? (shen.deref X V3017)) V3017
                                (freeze
                                 (cut Throwcontrol V3017
                                  (freeze
                                   (shen.syntax-hyps Y V3014 SynHyps V3016
                                    V3017 V3018)))))))))))))
                       (do (shen.unbindv V2420 V3017) Result))))
                    'false))))
                (IF
                 (AND (ARRAYP V2419) (NOT (STRINGP V2419))
                  (EQ (AREF V2419 0) 'shen.pvar))
                 (LET ((X (shen.newpv V3017)))
                  (LET ((A2411 (shen.newpv V3017)))
                   (do
                    (shen.bindv V2419 (CONS X (CONS '|:| (CONS A2411 NIL)))
                     V3017)
                    (LET
                     ((Result
                       (LET ((SynHyps (CDR V2418)))
                        (do (shen.incinfs)
                         (unify! V3016 A2411 V3017
                          (freeze
                           (unify! X X2410 V3017
                            (freeze
                             (fwhen (shen.ue? (shen.deref X V3017)) V3017
                              (freeze
                               (cut Throwcontrol V3017
                                (freeze
                                 (shen.syntax-hyps Y V3014 SynHyps V3016 V3017
                                  V3018)))))))))))))
                     (do (shen.unbindv V2419 V3017) Result)))))
                 'false)))
              (IF
               (AND (ARRAYP V2418) (NOT (STRINGP V2418))
                (EQ (AREF V2418 0) 'shen.pvar))
               (LET ((X (shen.newpv V3017)))
                (LET ((A2411 (shen.newpv V3017)))
                 (LET ((SynHyps (shen.newpv V3017)))
                  (do
                   (shen.bindv V2418
                    (CONS (CONS X (CONS '|:| (CONS A2411 NIL))) SynHyps) V3017)
                   (LET
                    ((Result
                      (do (shen.incinfs)
                       (unify! V3016 A2411 V3017
                        (freeze
                         (unify! X X2410 V3017
                          (freeze
                           (fwhen (shen.ue? (shen.deref X V3017)) V3017
                            (freeze
                             (cut Throwcontrol V3017
                              (freeze
                               (shen.syntax-hyps Y V3014 SynHyps V3016 V3017
                                V3018))))))))))))
                    (do (shen.unbindv V2418 V3017) Result))))))
               'false)))))
          'false))))
      (IF (shen.ABSEQUAL Case 'false)
       (LET ((V2426 (shen.lazyderef V3013 V3017)))
        (IF (CONSP V2426)
         (LET ((Y (CDR V2426)))
          (do (shen.incinfs)
           (shen.syntax-hyps Y V3014 V3015 V3016 V3017 V3018)))
         'false))
       Case))
     Case)))))

(DEFUN shen.syntax-check (V3019 V3020 V3021 V3022 V3023)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET
    ((Case
      (LET ((V2406 (shen.lazyderef V3019 V3022)))
       (IF (NULL V2406) (do (shen.incinfs) (thaw V3023)) 'false))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET
      ((Case
        (LET ((V2407 (shen.lazyderef V3019 V3022)))
         (IF (CONSP V2407)
          (LET ((X (CAR V2407)))
           (LET ((Syntax (CDR V2407)))
            (LET ((C (shen.newpv V3022)))
             (do (shen.incinfs)
              (fwhen (shen.grammar_symbol? (shen.lazyderef X V3022)) V3022
               (freeze
                (cut Throwcontrol V3022
                 (freeze
                  (shen.t*
                   (CONS X
                    (CONS '|:|
                     (CONS
                      (CONS (CONS 'list (CONS V3020 NIL))
                       (CONS '==> (CONS C NIL)))
                      NIL)))
                   V3021 V3022
                   (freeze
                    (cut Throwcontrol V3022
                     (freeze
                      (shen.syntax-check Syntax V3020 V3021 V3022
                       V3023)))))))))))))
          'false))))
      (IF (shen.ABSEQUAL Case 'false)
       (LET ((V2408 (shen.lazyderef V3019 V3022)))
        (IF (CONSP V2408)
         (LET ((X (CAR V2408)))
          (LET ((Syntax (CDR V2408)))
           (do (shen.incinfs)
            (shen.t* (CONS X (CONS '|:| (CONS V3020 NIL))) V3021 V3022
             (freeze
              (cut Throwcontrol V3022
               (freeze
                (shen.syntax-check Syntax V3020 V3021 V3022 V3023))))))))
         'false))
       Case))
     Case)))))

(DEFUN shen.semantics-check (V3024 V3025 V3026 V3027 V3028)
 (LET ((Throwcontrol (shen.catchpoint)))
  (shen.cutpoint Throwcontrol
   (LET
    ((Case
      (LET ((V2398 (shen.lazyderef V3024 V3027)))
       (IF (CONSP V2398)
        (LET ((V2399 (shen.lazyderef (CAR V2398) V3027)))
         (IF (EQ 'where V2399)
          (LET ((V2400 (shen.lazyderef (CDR V2398) V3027)))
           (IF (CONSP V2400)
            (LET ((P (CAR V2400)))
             (LET ((V2401 (shen.lazyderef (CDR V2400) V3027)))
              (IF (CONSP V2401)
               (LET ((Q (CAR V2401)))
                (LET ((V2402 (shen.lazyderef (CDR V2401) V3027)))
                 (IF (NULL V2402)
                  (do (shen.incinfs)
                   (cut Throwcontrol V3027
                    (freeze
                     (shen.t*
                      (CONS (shen.curry P) (CONS '|:| (CONS 'boolean NIL)))
                      V3026 V3027
                      (freeze
                       (shen.t*
                        (CONS (shen.curry Q) (CONS '|:| (CONS V3025 NIL)))
                        V3026 V3027 V3028))))))
                  'false)))
               'false)))
            'false))
          'false))
        'false))))
    (IF (shen.ABSEQUAL Case 'false)
     (LET ((Semantics* (shen.newpv V3027)))
      (do (shen.incinfs)
       (bind Semantics*
        (shen.curry (shen.rename-semantics (shen.deref V3024 V3027))) V3027
        (freeze
         (shen.t* (CONS Semantics* (CONS '|:| (CONS V3025 NIL))) V3026 V3027
          V3028)))))
     Case)))))

(DEFUN shen.rename-semantics (V3029)
 (COND
  ((CONSP V3029)
   (CONS (shen.rename-semantics (CAR V3029))
    (shen.rename-semantics (CDR V3029))))
  ((shen.wrapper (shen.grammar_symbol? V3029))
   (CONS 'shen.<-sem (CONS V3029 NIL)))
  (T V3029)))

"(defprolog syntax-check

  (mode [] -) _ _ <--;

  (mode [X | Syntax] -) A Hyps <-- (fwhen (grammar_symbol? X))

                                   !

                                   (t* [X : [[list B] ==> C]] Hyps)

                                   !

                                   (bind X&& (concat && X))

                                   !

                                   (t* [X&& : [list A]] [[X&& : [list B]] | Hyps]) 

                                   !

                                   (syntax-check Syntax A Hyps);

  (mode [X | Syntax] -) A Hyps <-- (t* [X : A] Hyps)

                                   !

                                   (syntax-check Syntax A Hyps);)"

